<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artik Food ‚Äî –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2ecc71">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    header {
      background: #2ecc71;
      color: white;
      padding: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    header img {
      height: 40px;
      width: auto;
    }
    header h1 {
      margin: 0;
      font-size: 20px;
    }

    main {
      padding: 10px;
    }

    .store-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
    }
    .store-card {
      background: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      text-align: center;
    }
    .store-card img {
      max-width: 100%;
      height: 40px;
      object-fit: contain;
      margin-bottom: 5px;
    }

    .category-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .category-list li {
      background: white;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .product-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .product-list li {
      background: white;
      padding: 10px;
      margin-bottom: 8px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .product-controls {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .product-controls button {
      padding: 4px 8px;
      border: none;
      border-radius: 6px;
      background: #2ecc71;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    .product-controls span {
      min-width: 20px;
      text-align: center;
      font-weight: bold;
    }

    .cart {
      background: white;
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .cart h3 {
      margin-top: 0;
    }
    .cart ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .cart li {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }

    /* üî¥ –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫, –≤—Å–µ–≥–¥–∞ –≤–∏–¥–µ–Ω, —Å–ø—Ä–∞–≤–∞ */
    .cart-item button {
      background: transparent;
      border: none;
      color: red;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      padding: 0;
      margin-left: auto;
      line-height: 1;
    }

    .nav-buttons {
      position: fixed;
      right: 10px;
      bottom: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .nav-buttons button {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: none;
      background: #2ecc71;
      color: white;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    .hidden {
      display: none;
    }

    .global-cart {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      border-top-left-radius: 15px;
      border-top-right-radius: 15px;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.2);
      padding: 10px;
      max-height: 50%;
      overflow-y: auto;
    }
    .global-cart h3 {
      margin-top: 0;
    }
    .global-cart ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .global-cart li {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 6px;
    }

    .admin-panel {
      background: white;
      border-radius: 10px;
      padding: 10px;
      margin-top: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .admin-panel h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>

<header>
  <img src="logo.png" alt="Artik Food">
  <h1>Artik Food</h1>
</header>

<main>

  <!-- –°–ø–∏—Å–æ–∫ –º–∞–≥–∞–∑–∏–Ω–æ–≤ -->
  <section id="stores-section">
    <h2>–ú–∞–≥–∞–∑–∏–Ω—ã</h2>
    <div class="store-list" id="storeList"></div>
  </section>

  <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
  <section id="categories-section" class="hidden">
    <h2 id="storeTitle"></h2>
    <ul class="category-list" id="categoryList"></ul>
  </section>

  <!-- –¢–æ–≤–∞—Ä—ã -->
  <section id="products-section" class="hidden">
    <h2 id="categoryTitle"></h2>
    <ul class="product-list" id="productList"></ul>
  </section>

  <!-- –ö–æ—Ä–∑–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞ -->
  <section id="store-cart-section" class="cart hidden">
    <h3>–ö–æ—Ä–∑–∏–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞</h3>
    <ul id="storeCartList"></ul>
  </section>

  <!-- –û–±—â–∞—è –∫–æ—Ä–∑–∏–Ω–∞ -->
  <section id="global-cart-section" class="global-cart hidden">
    <h3>–û–±—â–∞—è –∫–æ—Ä–∑–∏–Ω–∞</h3>
    <ul id="globalCartList"></ul>
  </section>

  <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
  <section id="admin-panel" class="admin-panel hidden">
    <h3>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h3>
    <div id="adminReport"></div>
  </section>

</main>

<!-- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
<div class="nav-buttons">
  <button id="homeBtn" title="–ù–∞ –≥–ª–∞–≤–Ω—É—é">üè†</button>
  <button id="backBtn" title="–ù–∞–∑–∞–¥">‚¨ÖÔ∏è</button>
  <button id="upBtn" title="–ù–∞–≤–µ—Ä—Ö">‚¨ÜÔ∏è</button>
</div>

<script>
  const defaultStores = {
    million: {
      name: "Million",
      logoInline: `
        <svg width="80" height="40" viewBox="0 0 200 80" xmlns="http://www.w3.org/2000/svg">
          <rect rx="12" ry="12" width="200" height="80" fill="#2ecc71"/>
          <text x="100" y="50" text-anchor="middle" font-size="28" fill="white" font-family="Arial" font-weight="bold">
            Million
          </text>
        </svg>
      `,
      categories: {
        "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã": [
          { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 300 },
          { name: "–õ—É–∫ 1–∫–≥", price: 250 },
          { name: "–ú–æ—Ä–∫–æ–≤—å 1–∫–≥", price: 200 }
        ],
        "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": [
          { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 450 },
          { name: "–°—ã—Ä 100–≥", price: 800 },
          { name: "–ô–æ–≥—É—Ä—Ç 150–≥", price: 250 }
        ],
        "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞": [
          { name: "–•–ª–µ–± –±–µ–ª—ã–π", price: 200 },
          { name: "–õ–∞–≤–∞—à", price: 150 },
          { name: "–ë—É–ª–æ—á–∫–∞", price: 120 }
        ]
      }
    },

    yerevan_city: {
      name: "Yerevan City",
      logoInline: `
        <svg width="80" height="40" viewBox="0 0 200 80" xmlns="http://www.w3.org/2000/svg">
          <rect rx="12" ry="12" width="200" height="80" fill="#3498db"/>
          <text x="100" y="50" text-anchor="middle" font-size="26" fill="white" font-family="Arial" font-weight="bold">
            Yerevan City
          </text>
        </svg>
      `,
      categories: {
        "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã": [
          { name: "–Ø–±–ª–æ–∫–∏ 1–∫–≥", price: 400 },
          { name: "–ë–∞–Ω–∞–Ω—ã 1–∫–≥", price: 600 },
          { name: "–ê–ø–µ–ª—å—Å–∏–Ω—ã 1–∫–≥", price: 500 }
        ],
        "–ú—è—Å–æ": [
          { name: "–ö—É—Ä–∏—Ü–∞ 1–∫–≥", price: 1600 },
          { name: "–ì–æ–≤—è–¥–∏–Ω–∞ 1–∫–≥", price: 3000 },
          { name: "–°–≤–∏–Ω–∏–Ω–∞ 1–∫–≥", price: 2800 }
        ],
        "–ù–∞–ø–∏—Ç–∫–∏": [
          { name: "–í–æ–¥–∞ 1.5–ª", price: 200 },
          { name: "–°–æ–∫ 1–ª", price: 500 },
          { name: "–ì–∞–∑–∏—Ä–æ–≤–∫–∞ 1–ª", price: 350 }
        ]
      }
    },

    nor_zovq: {
      name: "Nor Zovq",
      logoInline: `
        <svg width="80" height="40" viewBox="0 0 200 80" xmlns="http://www.w3.org/2000/svg">
          <rect rx="12" ry="12" width="200" height="80" fill="#e67e22"/>
          <text x="100" y="50" text-anchor="middle" font-size="28" fill="white" font-family="Arial" font-weight="bold">
            Nor Zovq
          </text>
        </svg>
      `,
      categories: {
        "–ë–∞–∫–∞–ª–µ—è": [
          { name: "–†–∏—Å 1–∫–≥", price: 600 },
          { name: "–ú–∞–∫–∞—Ä–æ–Ω—ã 500–≥", price: 350 },
          { name: "–°–∞—Ö–∞—Ä 1–∫–≥", price: 550 }
        ],
        "–ó–∞–º–æ—Ä–æ–∑–∫–∞": [
          { name: "–ü–µ–ª—å–º–µ–Ω–∏ 500–≥", price: 900 },
          { name: "–ö—É—Ä–∏–Ω—ã–µ –Ω–∞–≥–≥–µ—Ç—Å—ã 500–≥", price: 950 },
          { name: "–û–≤–æ—â–Ω–∞—è —Å–º–µ—Å—å 400–≥", price: 600 }
        ],
        "–°–ª–∞–¥–æ—Å—Ç–∏": [
          { name: "–®–æ–∫–æ–ª–∞–¥ 100–≥", price: 400 },
          { name: "–ü–µ—á–µ–Ω—å–µ 300–≥", price: 350 },
          { name: "–ö–æ–Ω—Ñ–µ—Ç—ã 200–≥", price: 500 }
        ]
      }
    },

    tonoyans_sity: {
      name: "Tonoyan City",
      logo: "tonoyan-city.png",
      categories: {
        "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã": [
          { name: "–û–≥—É—Ä—Ü—ã 1–∫–≥", price: 350 },
          { name: "–ü–æ–º–∏–¥–æ—Ä—ã 1–∫–≥", price: 500 },
          { name: "–ó–µ–ª–µ–Ω—å", price: 200 }
        ],
        "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": [
          { name: "–ö–µ—Ñ–∏—Ä 1–ª", price: 450 },
          { name: "–¢–≤–æ—Ä–æ–≥ 200–≥", price: 600 },
          { name: "–°–º–µ—Ç–∞–Ω–∞ 200–≥", price: 500 }
        ],
        "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞": [
          { name: "–•–ª–µ–± —á–µ—Ä–Ω—ã–π", price: 220 },
          { name: "–ë—É–ª–∫–∞", price: 180 },
          { name: "–õ–µ–ø–µ—à–∫–∞", price: 160 }
        ]
      }
    }
  };

  let stores = JSON.parse(localStorage.getItem("stores")) || defaultStores;
  let currentStoreKey = null;
  let currentCategory = null;
  let storeCart = {};
  let globalCart = JSON.parse(localStorage.getItem("globalCart")) || {};

  const storeListEl = document.getElementById("storeList");
  const categoryListEl = document.getElementById("categoryList");
  const productListEl = document.getElementById("productList");
  const storeCartListEl = document.getElementById("storeCartList");
  const globalCartListEl = document.getElementById("globalCartList");

  const storesSection = document.getElementById("stores-section");
  const categoriesSection = document.getElementById("categories-section");
  const productsSection = document.getElementById("products-section");
  const storeCartSection = document.getElementById("store-cart-section");
  const globalCartSection = document.getElementById("global-cart-section");
  const adminPanel = document.getElementById("admin-panel");

  const storeTitleEl = document.getElementById("storeTitle");
  const categoryTitleEl = document.getElementById("categoryTitle");
  const adminReportEl = document.getElementById("adminReport");

  const homeBtn = document.getElementById("homeBtn");
  const backBtn = document.getElementById("backBtn");
  const upBtn = document.getElementById("upBtn");

  function saveGlobalCart() {
    localStorage.setItem("globalCart", JSON.stringify(globalCart));
  }

  function renderStores() {
    storeListEl.innerHTML = "";
    Object.entries(stores).forEach(([key, store]) => {
      const card = document.createElement("div");
      card.className = "store-card";
      if (store.logo) {
        const img = document.createElement("img");
        img.src = store.logo;
        img.alt = store.name;
        card.appendChild(img);
      } else if (store.logoInline) {
        card.innerHTML = store.logoInline;
      }
      const name = document.createElement("div");
      name.textContent = store.name;
      card.appendChild(name);
      card.onclick = () => openStore(key);
      storeListEl.appendChild(card);
    });
  }

  function openStore(storeKey) {
    currentStoreKey = storeKey;
    currentCategory = null;
    storeCart = {};
    storeTitleEl.textContent = stores[storeKey].name;
    storesSection.classList.add("hidden");
    categoriesSection.classList.remove("hidden");
    productsSection.classList.add("hidden");
    storeCartSection.classList.remove("hidden");
    renderCategories();
    renderStoreCart();
  }

  function renderCategories() {
    categoryListEl.innerHTML = "";
    const categories = stores[currentStoreKey].categories;
    Object.keys(categories).forEach(category => {
      const li = document.createElement("li");
      li.textContent = category;
      li.onclick = () => openCategory(category);
      categoryListEl.appendChild(li);
    });
  }

  function openCategory(category) {
    currentCategory = category;
    categoryTitleEl.textContent = category;
    categoriesSection.classList.add("hidden");
    productsSection.classList.remove("hidden");
    renderProducts();
  }

  function renderProducts() {
    productListEl.innerHTML = "";
    const products = stores[currentStoreKey].categories[currentCategory];
    products.forEach(product => {
      const li = document.createElement("li");
      const info = document.createElement("div");
      info.textContent = `${product.name} ‚Äî ${product.price} ÷è`;

      const controls = document.createElement("div");
      controls.className = "product-controls";

      const minusBtn = document.createElement("button");
      minusBtn.textContent = "-";
      minusBtn.onclick = () => removeFromStoreCart(product);

      const countSpan = document.createElement("span");
      const key = `${product.name}`;
      countSpan.textContent = storeCart[key] || 0;

      const plusBtn = document.createElement("button");
      plusBtn.textContent = "+";
      plusBtn.onclick = () => addToStoreCart(product);

      controls.appendChild(minusBtn);
      controls.appendChild(countSpan);
      controls.appendChild(plusBtn);

      li.appendChild(info);
      li.appendChild(controls);
      productListEl.appendChild(li);
    });
  }

  function addToStoreCart(product) {
    const key = product.name;
    storeCart[key] = (storeCart[key] || 0) + 1;
    globalCart[currentStoreKey] = globalCart[currentStoreKey] || {};
    globalCart[currentStoreKey][key] = (globalCart[currentStoreKey][key] || 0) + 1;
    saveGlobalCart();
    renderProducts();
    renderStoreCart();
    renderGlobalCart();
  }

  function removeFromStoreCart(product) {
    const key = product.name;
    if (!storeCart[key]) return;
    storeCart[key]--;
    if (storeCart[key] <= 0) delete storeCart[key];
    if (globalCart[currentStoreKey] && globalCart[currentStoreKey][key]) {
      globalCart[currentStoreKey][key]--;
      if (globalCart[currentStoreKey][key] <= 0) delete globalCart[currentStoreKey][key];
      if (Object.keys(globalCart[currentStoreKey]).length === 0) delete globalCart[currentStoreKey];
    }
    saveGlobalCart();
    renderProducts();
    renderStoreCart();
    renderGlobalCart();
  }

  function renderStoreCart() {
    storeCartListEl.innerHTML = "";
    Object.entries(storeCart).forEach(([name, count]) => {
      const li = document.createElement("li");
      li.className = "cart-item";
      const text = document.createElement("span");
      text.textContent = `${name} x${count}`;
      const removeBtn = document.createElement("button");
      removeBtn.textContent = "‚úñ";
      removeBtn.onclick = () => removeItemCompletelyFromStore(name);
      li.appendChild(text);
      li.appendChild(removeBtn);
      storeCartListEl.appendChild(li);
    });
  }

  function removeItemCompletelyFromStore(name) {
    const count = storeCart[name];
    if (!count) return;
    delete storeCart[name];
    if (globalCart[currentStoreKey] && globalCart[currentStoreKey][name]) {
      delete globalCart[currentStoreKey][name];
      if (Object.keys(globalCart[currentStoreKey]).length === 0) delete globalCart[currentStoreKey];
    }
    saveGlobalCart();
    renderProducts();
    renderStoreCart();
    renderGlobalCart();
  }

  function renderGlobalCart() {
    globalCartListEl.innerHTML = "";
    Object.entries(globalCart).forEach(([storeKey, items]) => {
      const storeName = stores[storeKey]?.name || storeKey;
      const header = document.createElement("li");
      header.textContent = storeName;
      header.style.fontWeight = "bold";
      globalCartListEl.appendChild(header);

      Object.entries(items).forEach(([name, count]) => {
        const li = document.createElement("li");
        li.className = "cart-item";
        const text = document.createElement("span");
        text.textContent = `${name} x${count}`;
        const removeBtn = document.createElement("button");
        removeBtn.textContent = "‚úñ";
        removeBtn.onclick = () => removeItemCompletelyFromGlobal(storeKey, name);
        li.appendChild(text);
        li.appendChild(removeBtn);
        globalCartListEl.appendChild(li);
      });
    });

    globalCartSection.classList.toggle("hidden", Object.keys(globalCart).length === 0);
  }

  function removeItemCompletelyFromGlobal(storeKey, name) {
    if (!globalCart[storeKey] || !globalCart[storeKey][name]) return;
    delete globalCart[storeKey][name];
    if (Object.keys(globalCart[storeKey]).length === 0) delete globalCart[storeKey];
    saveGlobalCart();
    renderStoreCart();
    renderGlobalCart();
    renderProducts();
  }

  function showAdminPanel() {
    adminPanel.classList.remove("hidden");
    let reportHtml = "";
    Object.entries(globalCart).forEach(([storeKey, items]) => {
      const storeName = stores[storeKey]?.name || storeKey;
      reportHtml += `<h4>${storeName}</h4><ul>`;
      Object.entries(items).forEach(([name, count]) => {
        reportHtml += `<li>${name}: ${count}</li>`;
      });
      reportHtml += `</ul>`;
    });
    adminReportEl.innerHTML = reportHtml || "<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.</p>";
  }

  homeBtn.onclick = () => {
    currentStoreKey = null;
    currentCategory = null;
    storesSection.classList.remove("hidden");
    categoriesSection.classList.add("hidden");
    productsSection.classList.add("hidden");
    storeCartSection.classList.add("hidden");
  };

  backBtn.onclick = () => {
    if (!productsSection.classList.contains("hidden")) {
      productsSection.classList.add("hidden");
      categoriesSection.classList.remove("hidden");
    } else if (!categoriesSection.classList.contains("hidden")) {
      categoriesSection.classList.add("hidden");
      storesSection.classList.remove("hidden");
      storeCartSection.classList.add("hidden");
    }
  };

  upBtn.onclick = () => {
    window.scrollTo({ top: 0, behavior: "smooth" });
  };

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  renderStores();
  renderGlobalCart();
</script>

</body>
</html>
