<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artik Food ‚Äî –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</title>

  <!-- PWA MANIFEST INLINE -->
  <link rel="manifest" id="manifest-placeholder">

  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f8f8f8; color: #333; }
    header { background: #2ecc71; color: white; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
    header .logo-box { display:flex; align-items:center; gap:10px; cursor:pointer; }
    header img { height: 40px; }
    header h1 { margin: 0; font-size: 22px; }

    nav a { color: white; margin-left: 12px; text-decoration: none; font-weight: bold; font-size: 14px; }
    .lang-switch { margin-left: 12px; background:#fff; color:#2ecc71; border:none; border-radius:6px; padding:4px 8px; cursor:pointer; font-weight:bold; }

    .hero { background: #27ae60; color: white; padding: 40px 16px; text-align: center; }
    .hero h2 { font-size: 30px; margin-bottom: 10px; }
    .hero p { font-size: 17px; margin-bottom: 20px; }
    .hero button { background: white; color: #27ae60; border: none; padding: 12px 20px; font-size: 16px; border-radius: 6px; cursor: pointer; }

    .section { padding: 32px 16px; max-width: 1100px; margin: auto; }
    .section h3 { text-align: center; margin-bottom: 24px; }

    .shops, .categories, .products { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; }

    .card, .product { background: white; padding: 16px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); text-align: center; cursor: pointer; }
    .product button { background: #2ecc71; color: white; border: none; padding: 6px 10px; border-radius: 6px; cursor: pointer; font-size: 14px; }

    .product-list { display:flex; flex-direction:column; gap:12px; }

    .qty-controls { display:flex; justify-content:center; align-items:center; gap:8px; margin-top:8px; }
    .qty-controls button { width:28px; height:28px; border-radius:50%; border:none; background:#2ecc71; color:white; font-weight:bold; cursor:pointer; }
    .qty-number { min-width:20px; font-weight:bold; }

    .cart { background:white; padding:16px; border-radius:10px; max-width:500px; margin:20px auto; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .cart h4 { margin-top:0; text-align:center; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; font-size:14px; gap:8px; }
    .cart-total { font-weight:bold; margin-top:10px; text-align:center; }
    .cart button { width:100%; background:#27ae60; color:white; border:none; padding:10px; font-size:15px; border-radius:6px; cursor:pointer; margin-top:10px; }

    .order-form { background:white; padding:20px; border-radius:10px; max-width:500px; margin:auto; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .order-form input, .order-form textarea, .order-form select { width:100%; padding:10px; margin-bottom:12px; border-radius:6px; border:1px solid #ccc; font-size:14px; }
    .order-form button { width:100%; background:#27ae60; color:white; border:none; padding:12px; font-size:16px; border-radius:6px; cursor:pointer; }

    footer { background:#2ecc71; color:white; text-align:center; padding:16px; margin-top:40px; font-size:14px; }
    .hidden { display:none; }

    /* Admin + courier */
    .admin-login, .admin-panel, .courier-panel {
      max-width:700px;
      margin:40px auto;
      background:white;
      padding:20px;
      border-radius:10px;
      box-shadow:0 2px 6px rgba(0,0,0,0.1);
    }
    .admin-panel h3, .admin-panel h4, .courier-panel h3 { text-align:center; }
    .admin-panel select, .admin-panel input, .courier-panel input {
      width:100%;
      padding:8px;
      margin-bottom:10px;
      border-radius:6px;
      border:1px solid #ccc;
    }
    .admin-panel button, .courier-panel button {
      width:100%;
      background:#27ae60;
      color:white;
      border:none;
      padding:10px;
      border-radius:6px;
      cursor:pointer;
      margin-top:8px;
    }
    .admin-panel .danger { background:#e74c3c; }
    .report-box { border:1px solid #ddd; padding:10px; border-radius:6px; margin-bottom:10px; font-size:14px; }

    /* Floating buttons */
    .floating-buttons {
      position: fixed;
      bottom: 100px;
      right: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 9999;
    }
    .floating-buttons button {
      padding: 8px 12px;
      border: none;
      border-radius: 20px;
      background: #ff6b00;
      color: #fff;
      font-size: 13px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      cursor: pointer;
    }
    .floating-buttons button:hover { background:#e65c00; }

    .whatsapp-btn, .telegram-btn {
      position:fixed;
      right:16px;
      padding:10px 14px;
      border-radius:20px;
      text-decoration:none;
      font-weight:bold;
      box-shadow:0 4px 10px rgba(0,0,0,0.2);
      font-size:13px;
      display:flex;
      align-items:center;
      gap:6px;
      color:white;
    }
    .telegram-btn { bottom:16px; background:#0088cc; }
    .whatsapp-btn { bottom:56px; background:#25D366; }

    .search-box {
      max-width:500px;
      margin:10px auto;
      display:flex;
      gap:8px;
    }
    .search-box input {
      flex:1;
      padding:10px;
      border-radius:6px;
      border:1px solid #ccc;
      font-size:14px;
    }
    .search-box button {
      background:#27ae60;
      color:white;
      border:none;
      border-radius:6px;
      padding:10px 14px;
      cursor:pointer;
    }

    .status-badge {
      padding:4px 8px;
      border-radius:6px;
      font-size:12px;
      color:white;
    }
    .status-new { background:#3498db; }
    .status-processing { background:#f39c12; }
    .status-onway { background:#9b59b6; }
    .status-delivered { background:#2ecc71; }
    .status-cancelled { background:#e74c3c; }

  </style>
</head>
<body>

<header>
  <div class="logo-box" onclick="goHome()">
    <img src="logo.png" alt="Artik Food">
    <h1>Artik Food</h1>
  </div>
  <nav>
    <a href="#" onclick="goHome()">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="#" onclick="showAdminLogin()">–ê–¥–º–∏–Ω</a>
    <a href="#" onclick="showCourierPanel()">–ö—É—Ä—å–µ—Ä</a>
  </nav>
</header>

<section class="hero">
  <h2>–î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ü–≤–µ—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</h2>
  <p>–ó–∞–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏–∑ –ª—É—á—à–∏—Ö —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–æ–≤ –≥–æ—Ä–æ–¥–∞ ‚Äî –±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ.</p>
  <button onclick="scrollToShops()">–í—ã–±—Ä–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω</button>
</section>

<div class="search-box">
  <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º...">
  <button onclick="searchProducts()">–ù–∞–π—Ç–∏</button>
</div>

<section class="section" id="shops-section">
  <h3>–ú–∞–≥–∞–∑–∏–Ω—ã</h3>
  <div class="shops" id="shops"></div>
</section>

<section class="section hidden" id="categories-section">
  <button onclick="goBack()" style="margin-bottom:12px;">‚Üê –ù–∞–∑–∞–¥</button>
  <h3 id="categories-title"></h3>
  <div class="categories" id="categories"></div>
</section>

<section class="section hidden" id="products-section">
  <button onclick="goBackToCategories()" style="margin-bottom:12px;">‚Üê –ù–∞–∑–∞–¥</button>
  <h3 id="products-title"></h3>
  <div class="product-list" id="products"></div>
</section>

<section class="cart hidden" id="cart-section">
  <h4>–ö–æ—Ä–∑–∏–Ω–∞</h4>
  <div id="cart-items"></div>
  <div class="cart-total" id="cart-total"></div>
  <button onclick="showOrderForm()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</section>

<section class="order-form hidden" id="order-form">
  <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
  <input type="text" id="customer-name" placeholder="–í–∞—à–µ –∏–º—è">
  <input type="text" id="customer-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
  <input type="text" id="customer-address" placeholder="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏">
  <textarea id="customer-comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
  <button onclick="submitOrder()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
</section>

<!-- ADMIN -->
<section class="admin-login hidden" id="admin-login">
  <h3>–í—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
  <input type="password" id="admin-password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="loginAdmin()">–í–æ–π—Ç–∏</button>
</section>

<section class="admin-panel hidden" id="admin-panel">
  <h3>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h3>
  <button class="danger" onclick="logoutAdmin()">–í—ã–π—Ç–∏</button>

  <h4>–í—Å–µ –∑–∞–∫–∞–∑—ã</h4>
  <div id="admin-orders"></div>
</section>

<!-- COURIER -->
<section class="courier-panel hidden" id="courier-panel">
  <h3>–ü–∞–Ω–µ–ª—å –∫—É—Ä—å–µ—Ä–∞</h3>
  <input type="text" id="courier-name" placeholder="–ò–º—è –∫—É—Ä—å–µ—Ä–∞">
  <button onclick="loginCourier()">–í–æ–π—Ç–∏</button>

  <div id="courier-orders" class="hidden"></div>
</section>

<div class="floating-buttons">
  <button onclick="scrollToTop()">‚¨ÜÔ∏è –ù–∞–≤–µ—Ä—Ö</button>
  <button onclick="scrollToShops()">üè™ –ú–∞–≥–∞–∑–∏–Ω—ã</button>
  <button onclick="scrollToCart()">üõí –ö–æ—Ä–∑–∏–Ω–∞</button>
</div>

<a href="https://t.me/yourtelegram" target="_blank" class="telegram-btn">üì® Telegram</a>
<a href="https://wa.me/37400000000" target="_blank" class="whatsapp-btn">üí¨ WhatsApp</a>

<footer>
  ¬© 2026 Artik Food ‚Äî –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ü–≤–µ—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ
</footer>

<script>
/* =================== DATA =================== */
const stores = {
  million: {
    name: "Million",
    categories: {
      "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã": [
        { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 300 },
        { name: "–õ—É–∫ 1–∫–≥", price: 250 },
        { name: "–ü–æ–º–∏–¥–æ—Ä—ã 1–∫–≥", price: 600 },
        { name: "–Ø–±–ª–æ–∫–∏ 1–∫–≥", price: 400 }
      ],
      "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã": [
        { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 450 },
        { name: "–°–º–µ—Ç–∞–Ω–∞", price: 500 },
        { name: "–°—ã—Ä", price: 1200 }
      ],
      "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞": [
        { name: "–•–ª–µ–± –±–µ–ª—ã–π", price: 200 },
        { name: "–õ–∞–≤–∞—à", price: 150 }
      ]
    }
  },
  mush: {
    name: "’Ñ’∏÷Ç’∑",
    categories: {
      "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã": [
        { name: "–ë–∞–Ω–∞–Ω—ã 1–∫–≥", price: 650 },
        { name: "–ê–ø–µ–ª—å—Å–∏–Ω—ã 1–∫–≥", price: 550 }
      ],
      "–ù–∞–ø–∏—Ç–∫–∏": [
        { name: "–ö–æ–ª–∞ 1.5–ª", price: 450 },
        { name: "–°–æ–∫ 1–ª", price: 500 }
      ]
    }
  },
  tonoyan: {
    name: "Tonoyan",
    categories: {
      "–ú—è—Å–æ –∏ —Ä—ã–±–∞": [
        { name: "–ö—É—Ä–∏—Ü–∞ 1–∫–≥", price: 1400 },
        { name: "–ì–æ–≤—è–¥–∏–Ω–∞ 1–∫–≥", price: 3000 }
      ],
      "–ë–∞–∫–∞–ª–µ—è": [
        { name: "–†–∏—Å 1–∫–≥", price: 500 },
        { name: "–ú–∞–∫–∞—Ä–æ–Ω—ã", price: 400 }
      ]
    }
  },
  danielyan: {
    name: "Danielyan",
    categories: {
      "–°–ª–∞–¥–æ—Å—Ç–∏": [
        { name: "–¢–æ—Ä—Ç", price: 3500 },
        { name: "–ü–µ—á–µ–Ω—å–µ", price: 600 },
        { name: "–ö–æ–Ω—Ñ–µ—Ç—ã", price: 800 }
      ],
      "–ù–∞–ø–∏—Ç–∫–∏": [
        { name: "–ö–æ—Ñ–µ", price: 1500 },
        { name: "–ß–∞–π", price: 700 }
      ]
    }
  },
  edem: {
    name: "–≠–¥–µ–º (—Ü–≤–µ—Ç—ã)",
    categories: {
      "–ë—É–∫–µ—Ç—ã": [
        { name: "–ë—É–∫–µ—Ç —Ä–æ–∑", price: 6000 },
        { name: "–ë—É–∫–µ—Ç —Ç—é–ª—å–ø–∞–Ω–æ–≤", price: 5000 }
      ],
      "–ö–æ–º–ø–æ–∑–∏—Ü–∏–∏": [
        { name: "–¶–≤–µ—Ç–æ—á–Ω–∞—è –∫–æ—Ä–æ–±–∫–∞", price: 8000 },
        { name: "–ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Å –ª–∏–ª–∏—è–º–∏", price: 9000 }
      ]
    }
  }
};

let currentStore = null;
let currentCategory = null;
let cart = {};
let orders = JSON.parse(localStorage.getItem("orders") || "[]");

/* =================== INIT =================== */
renderShops();

/* =================== UI FUNCTIONS =================== */
function scrollToShops() {
  document.getElementById("shops-section").scrollIntoView({ behavior: "smooth" });
}
function scrollToTop() {
  window.scrollTo({ top: 0, behavior: "smooth" });
}
function scrollToCart() {
  document.getElementById("cart-section").scrollIntoView({ behavior: "smooth" });
}

function goHome() {
  document.getElementById("shops-section").classList.remove("hidden");
  document.getElementById("categories-section").classList.add("hidden");
  document.getElementById("products-section").classList.add("hidden");
  document.getElementById("cart-section").classList.remove("hidden");
  document.getElementById("order-form").classList.add("hidden");
  document.getElementById("admin-login").classList.add("hidden");
  document.getElementById("admin-panel").classList.add("hidden");
  document.getElementById("courier-panel").classList.add("hidden");
}

/* =================== SHOPS =================== */
function renderShops() {
  const shopsDiv = document.getElementById("shops");
  shopsDiv.innerHTML = "";
  for (let key in stores) {
    const store = stores[key];
    const card = document.createElement("div");
    card.className = "card";
    card.innerText = store.name;
    card.onclick = () => openStore(key);
    shopsDiv.appendChild(card);
  }
}

function openStore(storeKey) {
  currentStore = storeKey;
  const store = stores[storeKey];
  document.getElementById("categories-title").innerText = store.name;
  const categoriesDiv = document.getElementById("categories");
  categoriesDiv.innerHTML = "";
  for (let category in store.categories) {
    const card = document.createElement("div");
    card.className = "card";
    card.innerText = category;
    card.onclick = () => openCategory(category);
    categoriesDiv.appendChild(card);
  }
  document.getElementById("shops-section").classList.add("hidden");
  document.getElementById("categories-section").classList.remove("hidden");
  document.getElementById("products-section").classList.add("hidden");
}

/* =================== CATEGORIES =================== */
function openCategory(category) {
  currentCategory = category;
  const store = stores[currentStore];
  const products = store.categories[category];
  const productsDiv = document.getElementById("products");
  document.getElementById("products-title").innerText = category;
  productsDiv.innerHTML = "";

  products.forEach(product => {
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <div><strong>${product.name}</strong></div>
      <div>${product.price} –¥—Ä–∞–º</div>
      <div class="qty-controls">
        <button onclick="changeQty('${currentStore}', '${category}', '${product.name}', -1)">‚àí</button>
        <span class="qty-number" id="qty-${currentStore}-${category}-${product.name}">0</span>
        <button onclick="changeQty('${currentStore}', '${category}', '${product.name}', 1)">+</button>
      </div>
    `;
    productsDiv.appendChild(div);
  });

  document.getElementById("categories-section").classList.add("hidden");
  document.getElementById("products-section").classList.remove("hidden");
  document.getElementById("cart-section").classList.remove("hidden");
}

/* =================== NAV BACK =================== */
function goBack() {
  document.getElementById("categories-section").classList.add("hidden");
  document.getElementById("shops-section").classList.remove("hidden");
}
function goBackToCategories() {
  document.getElementById("products-section").classList.add("hidden");
  document.getElementById("categories-section").classList.remove("hidden");
}

/* =================== CART =================== */
function changeQty(store, category, name, delta) {
  const key = `${store}|${category}|${name}`;
  if (!cart[key]) cart[key] = { store, category, name, qty: 0, price: getProductPrice(store, category, name) };
  cart[key].qty += delta;
  if (cart[key].qty <= 0) delete cart[key];
  updateQtyDisplay(store, category, name);
  renderCart();
}

function updateQtyDisplay(store, category, name) {
  const key = `${store}|${category}|${name}`;
  const span = document.getElementById(`qty-${store}-${category}-${name}`);
  if (span) span.innerText = cart[key]?.qty || 0;
}

function getProductPrice(store, category, name) {
  const products = stores[store].categories[category];
  const product = products.find(p => p.name === name);
  return product ? product.price : 0;
}

function renderCart() {
  const cartSection = document.getElementById("cart-section");
  const cartItemsDiv = document.getElementById("cart-items");
  const cartTotalDiv = document.getElementById("cart-total");

  cartItemsDiv.innerHTML = "";
  let total = 0;

  for (let key in cart) {
    const item = cart[key];
    const itemTotal = item.qty * item.price;
    total += itemTotal;
    const div = document.createElement("div");
    div.className = "cart-item";
    div.innerHTML = `
      <span>${item.name} √ó ${item.qty}</span>
      <span>${itemTotal} –¥—Ä–∞–º</span>
    `;
    cartItemsDiv.appendChild(div);
  }

  cartTotalDiv.innerText = `–ò—Ç–æ–≥–æ: ${total} –¥—Ä–∞–º`;
  if (Object.keys(cart).length > 0) cartSection.classList.remove("hidden");
  else cartSection.classList.add("hidden");
}

/* =================== ORDER =================== */
function showOrderForm() {
  document.getElementById("order-form").classList.remove("hidden");
}

function submitOrder() {
  const name = document.getElementById("customer-name").value;
  const phone = document.getElementById("customer-phone").value;
  const address = document.getElementById("customer-address").value;
  const comment = document.getElementById("customer-comment").value;

  if (!name || !phone || !address) {
    alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.");
    return;
  }

  const order = {
    id: Date.now(),
    name,
    phone,
    address,
    comment,
    items: Object.values(cart),
    status: "new",
    courier: null,
    date: new Date().toLocaleString()
  };

  orders.push(order);
  localStorage.setItem("orders", JSON.stringify(orders));
  cart = {};
  renderCart();
  document.getElementById("order-form").classList.add("hidden");
  alert("–í–∞—à –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç! –ú—ã —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.");
}

/* =================== ADMIN =================== */
function showAdminLogin() {
  goHome();
  document.getElementById("admin-login").classList.remove("hidden");
}

function loginAdmin() {
  const password = document.getElementById("admin-password").value;
  if (password === "1234") {
    document.getElementById("admin-login").classList.add("hidden");
    document.getElementById("admin-panel").classList.remove("hidden");
    renderAdminOrders();
  } else {
    alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
  }
}

function logoutAdmin() {
  document.getElementById("admin-panel").classList.add("hidden");
}

function renderAdminOrders() {
  const div = document.getElementById("admin-orders");
  div.innerHTML = "";

  orders.forEach(order => {
    const box = document.createElement("div");
    box.className = "report-box";
    box.innerHTML = `
      <strong>–ó–∞–∫–∞–∑ ‚Ññ${order.id}</strong><br>
      ${order.date}<br>
      –ö–ª–∏–µ–Ω—Ç: ${order.name}, ${order.phone}<br>
      –ê–¥—Ä–µ—Å: ${order.address}<br>
      –°—Ç–∞—Ç—É—Å: <span class="status-badge status-${order.status}">${getStatusText(order.status)}</span><br>
      –ö—É—Ä—å–µ—Ä: ${order.courier || "–Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"}<br>
      <hr>
      ${order.items.map(i => `${i.name} √ó ${i.qty}`).join("<br>")}
      <hr>
      <select onchange="updateOrderStatus(${order.id}, this.value)">
        <option value="new" ${order.status==="new"?"selected":""}>–ù–æ–≤—ã–π</option>
        <option value="processing" ${order.status==="processing"?"selected":""}>–ì–æ—Ç–æ–≤–∏—Ç—Å—è</option>
        <option value="onway" ${order.status==="onway"?"selected":""}>–í –ø—É—Ç–∏</option>
        <option value="delivered" ${order.status==="delivered"?"selected":""}>–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
        <option value="cancelled" ${order.status==="cancelled"?"selected":""}>–û—Ç–º–µ–Ω—ë–Ω</option>
      </select>
    `;
    div.appendChild(box);
  });
}

function updateOrderStatus(orderId, status) {
  const order = orders.find(o => o.id === orderId);
  if (order) {
    order.status = status;
    localStorage.setItem("orders", JSON.stringify(orders));
    renderAdminOrders();
  }
}

/* =================== COURIER =================== */
function showCourierPanel() {
  goHome();
  document.getElementById("courier-panel").classList.remove("hidden");
}

function loginCourier() {
  const name = document.getElementById("courier-name").value;
  if (!name) {
    alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫—É—Ä—å–µ—Ä–∞");
    return;
  }
  document.getElementById("courier-orders").classList.remove("hidden");
  renderCourierOrders(name);
}

function renderCourierOrders(courierName) {
  const div = document.getElementById("courier-orders");
  div.innerHTML = "<h4>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã</h4>";

  orders.forEach(order => {
    if (!order.courier || order.courier === courierName) {
      const box = document.createElement("div");
      box.className = "report-box";
      box.innerHTML = `
        <strong>–ó–∞–∫–∞–∑ ‚Ññ${order.id}</strong><br>
        ${order.date}<br>
        –ö–ª–∏–µ–Ω—Ç: ${order.name}<br>
        –ê–¥—Ä–µ—Å: ${order.address}<br>
        –°—Ç–∞—Ç—É—Å: <span class="status-badge status-${order.status}">${getStatusText(order.status)}</span><br>
        –ö—É—Ä—å–µ—Ä: ${order.courier || "–Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"}<br>
        <hr>
        ${order.items.map(i => `${i.name} √ó ${i.qty}`).join("<br>")}
        <hr>
        ${order.courier ? "" : `<button onclick="assignCourier(${order.id}, '${courierName}')">–í–∑—è—Ç—å –∑–∞–∫–∞–∑</button>`}
        <select onchange="courierUpdateStatus(${order.id}, this.value)">
          <option value="">–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</option>
          <option value="processing">–ì–æ—Ç–æ–≤–∏—Ç—Å—è</option>
          <option value="onway">–í –ø—É—Ç–∏</option>
          <option value="delivered">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
        </select>
      `;
      div.appendChild(box);
    }
  });
}

function assignCourier(orderId, courierName) {
  const order = orders.find(o => o.id === orderId);
  if (order) {
    order.courier = courierName;
    localStorage.setItem("orders", JSON.stringify(orders));
    renderCourierOrders(courierName);
  }
}

function courierUpdateStatus(orderId, status) {
  if (!status) return;
  const order = orders.find(o => o.id === orderId);
  if (order) {
    order.status = status;
    localStorage.setItem("orders", JSON.stringify(orders));
    renderCourierOrders(order.courier);
  }
}

function getStatusText(status) {
  switch(status) {
    case "new": return "–ù–æ–≤—ã–π";
    case "processing": return "–ì–æ—Ç–æ–≤–∏—Ç—Å—è";
    case "onway": return "–í –ø—É—Ç–∏";
    case "delivered": return "–î–æ—Å—Ç–∞–≤–ª–µ–Ω";
    case "cancelled": return "–û—Ç–º–µ–Ω—ë–Ω";
    default: return status;
  }
}

/* =================== SEARCH =================== */
function searchProducts() {
  const query = document.getElementById("searchInput").value.toLowerCase().trim();
  if (!query) return;

  const results = [];
  for (let storeKey in stores) {
    const store = stores[storeKey];
    for (let category in store.categories) {
      store.categories[category].forEach(product => {
        if (product.name.toLowerCase().includes(query)) {
          results.push({ storeKey, storeName: store.name, category, product });
        }
      });
    }
  }

  if (results.length === 0) {
    alert("–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.");
    return;
  }

  document.getElementById("shops-section").classList.add("hidden");
  document.getElementById("categories-section").classList.add("hidden");
  document.getElementById("products-section").classList.remove("hidden");
  document.getElementById("products-title").innerText = "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞";
  const productsDiv = document.getElementById("products");
  productsDiv.innerHTML = "";

  results.forEach(res => {
    const div = document.createElement("div");
    div.className = "product";
    div.innerHTML = `
      <div><strong>${res.product.name}</strong></div>
      <div>${res.product.price} –¥—Ä–∞–º</div>
      <div style="font-size:12px;color:#777;">${res.storeName} ‚Äî ${res.category}</div>
      <div class="qty-controls">
        <button onclick="changeQty('${res.storeKey}', '${res.category}', '${res.product.name}', -1)">‚àí</button>
        <span class="qty-number" id="qty-${res.storeKey}-${res.category}-${res.product.name}">0</span>
        <button onclick="changeQty('${res.storeKey}', '${res.category}', '${res.product.name}', 1)">+</button>
      </div>
    `;
    productsDiv.appendChild(div);
  });
}

/* =================== PWA INLINE =================== */

// Create manifest dynamically
const manifestData = {
  name: "Artik Food",
  short_name: "Artik Food",
  start_url: ".",
  display: "standalone",
  background_color: "#ffffff",
  theme_color: "#2ecc71",
  icons: [
    {
      src: "icon-192.png",
      sizes: "192x192",
      type: "image/png"
    },
    {
      src: "icon-512.png",
      sizes: "512x512",
      type: "image/png"
    }
  ]
};
const manifestBlob = new Blob([JSON.stringify(manifestData)], { type: "application/json" });
const manifestURL = URL.createObjectURL(manifestBlob);
document.getElementById("manifest-placeholder").setAttribute("href", manifestURL);

// Service Worker inline
if ("serviceWorker" in navigator) {
  const swCode = `
    const CACHE_NAME = 'artik-food-cache-v1';
    const urlsToCache = [
      '/',
    ];

    self.addEventListener('install', event => {
      event.waitUntil(
        caches.open(CACHE_NAME).then(cache => cache.addAll(urlsToCache))
      );
    });

    self.addEventListener('fetch', event => {
      event.respondWith(
        caches.match(event.request).then(response => {
          return response || fetch(event.request);
        })
      );
    });
  `;
  const swBlob = new Blob([swCode], { type: "application/javascript" });
  const swURL = URL.createObjectURL(swBlob);
  navigator.serviceWorker.register(swURL).then(reg => {
    console.log("Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:", reg.scope);
  }).catch(err => {
    console.error("–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:", err);
  });
}

</script>

</body>
</html>
