<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artik Food ‚Äî Premium Delivery</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f1115">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-main: #0f1115;
      --bg-secondary: #151822;
      --bg-card: rgba(255,255,255,0.06);
      --bg-glass: rgba(255,255,255,0.08);
      --border-glass: rgba(255,255,255,0.12);
      --accent-gold: #d4af37;
      --accent-green: #2ecc71;
      --text-main: #f4f4f4;
      --text-muted: #b3b3b3;
      --shadow-soft: 0 10px 30px rgba(0,0,0,0.35);
      --shadow-hover: 0 16px 40px rgba(0,0,0,0.5);
      --radius-xl: 20px;
      --radius-lg: 16px;
      --radius-md: 12px;
    }

    body.light-theme {
      --bg-main: #f7f7f9;
      --bg-secondary: #ffffff;
      --bg-card: rgba(0,0,0,0.04);
      --bg-glass: rgba(0,0,0,0.05);
      --border-glass: rgba(0,0,0,0.12);
      --accent-gold: #b08a1f;
      --accent-green: #27ae60;
      --text-main: #1c1c1e;
      --text-muted: #6e6e73;
      --shadow-soft: 0 8px 24px rgba(0,0,0,0.08);
      --shadow-hover: 0 14px 34px rgba(0,0,0,0.12);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: "Inter", sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, #1b1f2b 0%, #0f1115 50%, #0b0d12 100%);
      color: var(--text-main);
      line-height: 1.5;
      transition: background 0.3s ease, color 0.3s ease;
    }

    body.light-theme {
      background: radial-gradient(1200px 600px at 20% -10%, #ffffff 0%, #f2f2f6 50%, #ececf1 100%);
    }

    a { color: var(--accent-gold); text-decoration: none; }
    a:hover { text-decoration: underline; }

    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      background: linear-gradient(180deg, rgba(15,17,21,0.95), rgba(15,17,21,0.85));
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-glass);
      padding: 14px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    body.light-theme header {
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85));
    }

    header .logo-box {
      display:flex;
      align-items:center;
      gap:12px;
      cursor:pointer;
      user-select:none;
      flex-wrap: wrap;
    }

    header img {
      height: 40px;
      filter: drop-shadow(0 0 6px rgba(212,175,55,0.35));
    }

    header h1 {
      margin: 0;
      font-family: "Playfair Display", serif;
      font-weight: 600;
      font-size: 22px;
      letter-spacing: 0.5px;
      color: var(--accent-gold);
    }

    .search-container input{
      width: 260px;
      max-width: 60vw;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.06);
      color: var(--text-main);
      outline: none;
    }
    body.light-theme .search-container input{
      background: rgba(0,0,0,0.04);
      border: 1px solid rgba(0,0,0,0.12);
      color: var(--text-main);
    }

    nav {
      display: flex;
      align-items: center;
      gap: 14px;
      flex-wrap: wrap;
    }

    nav a {
      color: var(--text-main);
      font-weight: 500;
      font-size: 14px;
      padding: 6px 10px;
      border-radius: 10px;
      transition: background 0.2s, color 0.2s;
    }

    nav a:hover {
      background: var(--bg-glass);
      color: var(--accent-gold);
    }

    .theme-toggle {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      border: 1px solid var(--border-glass);
      background: var(--bg-glass);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      box-shadow: var(--shadow-soft);
      transition: background 0.2s, box-shadow 0.2s, transform 0.15s;
    }

    .theme-toggle:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-hover);
      background: rgba(212,175,55,0.15);
      color: var(--accent-gold);
    }

    .hero {
      padding: 70px 20px 60px;
      text-align: center;
      background:
        radial-gradient(600px 300px at 50% -10%, rgba(212,175,55,0.18), transparent 70%),
        radial-gradient(800px 400px at 80% 0%, rgba(46,204,113,0.15), transparent 70%);
    }

    .hero h2 {
      font-family: "Playfair Display", serif;
      font-size: 40px;
      margin-bottom: 12px;
      letter-spacing: 0.5px;
      color: #ffffff;
    }

    body.light-theme .hero h2 { color: #1c1c1e; }

    .hero p {
      font-size: 17px;
      color: var(--text-muted);
      margin-bottom: 26px;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .hero button {
      background: linear-gradient(135deg, #d4af37, #f1d67a);
      color: #0f1115;
      border: none;
      padding: 14px 28px;
      font-size: 15px;
      border-radius: 999px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 8px 24px rgba(212,175,55,0.35);
      transition: transform 0.15s, box-shadow 0.15s;
    }

    .hero button:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 30px rgba(212,175,55,0.5);
    }

    .section {
      padding: 48px 20px;
      max-width: 1200px;
      margin: auto;
    }

    .section h3 {
      text-align: center;
      margin-bottom: 30px;
      font-family: "Playfair Display", serif;
      font-weight: 600;
      font-size: 28px;
      letter-spacing: 0.4px;
      color: var(--accent-gold);
    }

    .shops, .categories {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 18px;
    }

    .products {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .card, .product {
      background: linear-gradient(180deg, var(--bg-glass), rgba(255,255,255,0.02));
      border: 1px solid var(--border-glass);
      border-radius: var(--radius-xl);
      padding: 18px 16px;
      box-shadow: var(--shadow-soft);
      text-align: center;
      cursor: pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
    }

    .card:hover, .product:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-hover);
      border-color: rgba(212,175,55,0.4);
    }

    .card img {
      max-width: 90px;
      max-height: 70px;
      object-fit: contain;
      margin-bottom: 10px;
      filter: drop-shadow(0 0 8px rgba(212,175,55,0.25));
    }

    .card .icon {
      font-size: 38px;
      margin-bottom: 8px;
      display: block;
    }

    .card div {
      font-weight: 600;
      letter-spacing: 0.2px;
    }

    .product {
      display: flex;
      justify-content: space-between;
      align-items: center;
      text-align: left;
      gap: 14px;
      padding: 16px 18px;
    }

    .product img {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 14px;
      background: rgba(255,255,255,0.1);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.15);
    }

    .product h4 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
      color: var(--text-main);
    }

    .product p {
      margin: 6px 0 0;
      font-size: 14px;
      color: var(--text-muted);
    }

    .qty-controls {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      user-select:none;
    }

    .qty-controls button {
      width:32px;
      height:32px;
      border-radius:50%;
      border:none;
      background: linear-gradient(135deg, #2ecc71, #6df0a0);
      color:#0f1115;
      font-weight:700;
      cursor:pointer;
      box-shadow: 0 4px 14px rgba(46,204,113,0.35);
      transition: transform 0.15s, box-shadow 0.15s;
    }

    .qty-controls button:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 22px rgba(46,204,113,0.55);
    }

    .qty-number {
      min-width:24px;
      font-weight:600;
      text-align:center;
      color: var(--text-main);
    }

    .cart {
      background: linear-gradient(180deg, var(--bg-glass), rgba(255,255,255,0.02));
      border: 1px solid var(--border-glass);
      padding: 18px 16px;
      border-radius: var(--radius-xl);
      max-width: 540px;
      margin: 20px auto;
      box-shadow: var(--shadow-soft);
    }

    .cart h4 {
      margin-top:0;
      text-align:center;
      font-family: "Playfair Display", serif;
      font-weight: 600;
      font-size: 20px;
      color: var(--accent-gold);
      margin-bottom: 14px;
    }

    .cart-item {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:10px;
      font-size:14px;
      gap:10px;
      color: var(--text-main);
    }

    .cart-item span { color: var(--text-muted); }

    .cart-total {
      font-weight:600;
      margin-top:10px;
      text-align:center;
      color: var(--text-main);
    }

    .cart-item button {
      background: rgba(255,255,255,0.12) !important;
      border: 1px solid rgba(255,255,255,0.25);
      color: #ff6b6b;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      font-size: 12px;
      cursor: pointer;
      padding: 0;
      margin-left: auto;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, transform 0.15s, box-shadow 0.15s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    }

    .cart-item button:hover {
      background: rgba(255,107,107,0.15) !important;
      transform: scale(1.05);
      box-shadow: 0 6px 14px rgba(255,107,107,0.35);
    }

    .order-form {
      background: linear-gradient(180deg, var(--bg-glass), rgba(255,255,255,0.02));
      border: 1px solid var(--border-glass);
      padding: 22px 20px;
      border-radius: var(--radius-xl);
      max-width: 540px;
      margin: auto;
      box-shadow: var(--shadow-soft);
    }

    .order-form input,
    .order-form textarea,
    .order-form select {
      width:100%;
      padding:12px 14px;
      margin-bottom:14px;
      border-radius:12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: rgba(255,255,255,0.06);
      color: var(--text-main);
      font-size:14px;
      outline: none;
    }

    body.light-theme .order-form input,
    body.light-theme .order-form textarea,
    body.light-theme .order-form select {
      background: rgba(0,0,0,0.04);
      border: 1px solid rgba(0,0,0,0.12);
    }

    .order-form input::placeholder,
    .order-form textarea::placeholder {
      color: var(--text-muted);
    }

    .order-form button {
      width:100%;
      background: linear-gradient(135deg, #2ecc71, #6df0a0);
      color:#0f1115;
      border:none;
      padding:14px;
      font-size:16px;
      border-radius:999px;
      cursor:pointer;
      font-weight:600;
      box-shadow: 0 8px 24px rgba(46,204,113,0.35);
      transition: transform 0.15s, box-shadow 0.15s;
    }
const stores = {
  hay_grill: {
    name: "Hay Grill (’Ä’°’µ ‘≥÷Ä’´’¨)",
    icon: "üî•",
    categories: {
      "–ú–∞–Ω–≥–∞–ª": "üî•",
      "–®–∞—É—Ä–º–∞": "üåØ",
      "–ö–µ–±–∞–±": "üç¢",
      "–ü–∏—Ü—Ü–∞": "üçï",
      "–ù–∞–ø–∏—Ç–∫–∏": "ü•§"
    },
    products: [
      { name: "‘Ω’∏’¶’´ ’π’°’¨’°’≤’°’ª (–ß–∞–ª–∞–≥–∞–¥–∂)", price: 4200, category: "–ú–∞–Ω–≥–∞–ª", desc: "1–∫–≥ - —Å–≤–∏–Ω–∏–Ω–∞, —Å–æ—Ö, –∑–µ–ª–µ–Ω—å, –ª–∞–≤–∞—à", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "‘Ω’∏’¶’´ ’¥’°’ø (–†–µ–±—Ä—ã—à–∫–∏)", price: 3800, category: "–ú–∞–Ω–≥–∞–ª", desc: "1–∫–≥ - —Å–≤–∏–Ω—ã–µ —Ä–µ–±—Ä—ã—à–∫–∏, —Å–æ—Ö, –∑–µ–ª–µ–Ω—å, –ª–∞–≤–∞—à", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "’≠’∏’¶’´ ’∑’°’∏÷Ç÷Ä’¥’° (–®–∞—É—Ä–º–∞)", price: 950, category: "–®–∞—É—Ä–º–∞", desc: "—Å–≤–∏–Ω–∏–Ω–∞, —Å–∞–ª–∞—Ç, –æ–≤–æ—â–∏, —Ñ—Ä–∏, 2 —Å–æ—É—Å–∞", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "’è’°’æ’°÷Ä’´ ÷Ñ’µ’°’¢’°’¢ (–ö–µ–±–∞–±)", price: 750, category: "–ö–µ–±–∞–±", desc: "–≥–æ–≤—è–¥–∏–Ω–∞, —Å–æ—Ö, –∑–µ–ª–µ–Ω—å, –ª–∞–≤–∞—à", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "’ä’•’∫’•÷Ä’∏’∂’´ (–ü–µ–ø–ø–µ—Ä–æ–Ω–∏)", price: 3500, category: "–ü–∏—Ü—Ü–∞", desc: "–ø–µ–ø–ø–µ—Ä–æ–Ω–∏, –º–æ—Ü–∞—Ä–µ–ª–ª–∞, 2 –≤–∏–¥–∞ —Å–æ—É—Å–∞", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "’Ä’°’æ’´ ’∂’°’£’•’ø’Ω (–ù–∞–≥–≥–µ—Ç—Å—ã)", price: 400, category: "–ü–∏—Ü—Ü–∞", desc: "1 –ø–æ—Ä—Ü–∏—è –∫—É—Ä–∏–Ω—ã—Ö –Ω–∞–≥–≥–µ—Ç—Å–æ–≤", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "Jermuk 330ml", price: 400, category: "–ù–∞–ø–∏—Ç–∫–∏", desc: "–ú–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è –≤–æ–¥–∞", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "Boom Energy 450ml", price: 400, category: "–ù–∞–ø–∏—Ç–∫–∏", desc: "–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞–ø–∏—Ç–æ–∫", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "’ç’∫’´’ø’°’Ø ’Ω’∏’∏÷Ç’Ω (–ë–µ–ª—ã–π)", price: 200, category: "–ù–∞–ø–∏—Ç–∫–∏", desc: "–ß–µ—Å–Ω–æ—á–Ω—ã–π —Å–æ—É—Å", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" },
      { name: "‘ø’°÷Ä’¥’´÷Ä ’Ω’∏’∏÷Ç’Ω (–ö—Ä–∞—Å–Ω—ã–π)", price: 200, category: "–ù–∞–ø–∏—Ç–∫–∏", desc: "–¢–æ–º–∞—Ç–Ω—ã–π —Å–æ—É—Å", img: "https://lh3.googleusercontent.com/d/1fyoI2bIXQzCguhF0Q3EYQbRq3qccswNH" }
    ]
  }
};
  <section class="section" id="contacts">
    <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
    <div class="card" style="max-width:420px; margin:auto;">
      <p>üìû –¢–µ–ª–µ—Ñ–æ–Ω / WhatsApp: <a href="tel:+37443797727">+374 43 79 77 27</a></p>
      <p>‚úàÔ∏è Telegram: @artikfood</p>
      <p>üìç –ê—Ä—Ç–∏–∫, –®–∏—Ä–∞–∫, –ê—Ä–º–µ–Ω–∏—è</p>
    </div>
  </section>
</section>

<div class="floating-icons">
  <a href="#order" class="cart-icon" title="–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑">üõí</a>
</div>

<div class="floating-buttons">
  <button onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
  <button onclick="goHome()">üè† –ì–ª–∞–≤–Ω–∞—è</button>
</div>

<footer>
  <p>¬© 2026 Artik Food ‚Äî Premium –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</p>
</footer>

<div id="admin-panel" class="hidden">
  <div style="background: linear-gradient(180deg, rgba(15,17,21,0.95), rgba(15,17,21,0.9)); color:inherit; padding:12px 16px; display:flex; justify-content:space-between; align-items:center; border-bottom: 1px solid var(--border-glass);">
    <h3 style="margin:0; font-family:'Playfair Display', serif; font-weight:600; color: var(--accent-gold);">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
    <button onclick="hideAdminPanel()" style="background: rgba(255,107,107,0.15); color:#ff6b6b; border: 1px solid rgba(255,107,107,0.4); width:22px; height:22px; border-radius:50%; font-weight:700; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:12px;">‚úï</button>
  </div>
  <div style="padding:20px; max-width:900px; margin:auto;">
    <div class="admin-card">
      <p style="margin:0; opacity:.8;">(–î–µ–º–æ –ø–∞–Ω–µ–ª—å ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ)</p>
    </div>
  </div>
</div>

<script>
/* ====== –≠–∫—Ä–∞–Ω –æ—à–∏–±–æ–∫ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë —É–ø–∞–¥—ë—Ç ‚Äî —É–≤–∏–¥–∏—à—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ) ====== */
(function showErrorsOnScreen(){
  const box = document.createElement('div');
  box.style.cssText = "position:fixed;left:10px;right:10px;bottom:10px;max-height:45vh;overflow:auto;z-index:999999;background:rgba(0,0,0,.85);color:#fff;padding:10px;border-radius:12px;font:12px/1.4 monospace;white-space:pre-wrap;display:none";
  document.addEventListener('DOMContentLoaded', () => document.body.appendChild(box));
  function log(msg){ box.style.display="block"; box.textContent += msg + "\n\n"; }
  window.addEventListener('error', (e) => log("JS ERROR: " + (e.message || e.error) + "\n" + (e.filename||"") + ":" + (e.lineno||"") + ":" + (e.colno||"")));
  window.addEventListener('unhandledrejection', (e) => log("PROMISE ERROR: " + (e.reason && (e.reason.stack || e.reason.message || e.reason)) ));
})();
</script>

<script>
/* ---------------- –¢–ï–ú–ê ---------------- */
const themeToggle = document.getElementById('themeToggle');

function setTheme(theme) {
  if (theme === 'light') {
    document.body.classList.add('light-theme');
    themeToggle.textContent = 'üåû';
  } else {
    document.body.classList.remove('light-theme');
    themeToggle.textContent = 'üåô';
  }
  localStorage.setItem('artikTheme', theme);
}

themeToggle.addEventListener('click', () => {
  const isLight = document.body.classList.contains('light-theme');
  setTheme(isLight ? 'dark' : 'light');
});

(function initTheme() {
  const savedTheme = localStorage.getItem('artikTheme');
  setTheme(savedTheme || 'dark');
})();

/* ---------------- –°–ö–†–´–¢–ê–Ø –ê–î–ú–ò–ù–ö–ê (5 –∫–ª–∏–∫–æ–≤ –ø–æ –ª–æ–≥–æ—Ç–∏–ø—É) ---------------- */
let logoClickCount = 0;
const logoBox = document.getElementById('logoBox');
logoBox.addEventListener('click', () => {
  logoClickCount++;
  if (logoClickCount === 5) {
    showAdminPanel();
    logoClickCount = 0;
  }
  setTimeout(() => { logoClickCount = 0; }, 1200);
});

/* ===================== FIX: –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ ID/—Å—Ç—Ä–æ–∫–∏ ===================== */
function qtyId(storeKey, productName) {
  return `qty-${storeKey}-${encodeURIComponent(productName).replace(/%/g, '_')}`;
}
function jsSafe(str) {
  return String(str).replace(/\\/g, "\\\\").replace(/'/g, "\\'");
}
function decodeSafe(str){
  return String(str).replace(/\\'/g, "'").replace(/\\\\/g, "\\");
}

/* ---------------- –î–ê–ù–ù–´–ï ---------------- */
/* --- –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í–´–ô –ë–õ–û–ö –î–õ–Ø –í–ê–®–ò–• –ú–ê–ì–ê–ó–ò–ù–û–í --- */
const stores = {
  hay_grill: {
    name: "Hay Grill (’Ä’°’µ ‘≥÷Ä’´’¨)",
    icon: "üî•",
    // –°—Å—ã–ª–∫–∞ –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø –∏–∑ –≤–∞—à–µ–π –ø–∞–ø–∫–∏ Hay Grill
    logo: "https://drive.google.com/file/d/1o7yRSjBUVK4TkIWZSFl7174Iy7Wk5Gv5/view?usp=sharing", 
    categories: { "–®–∞—É—Ä–º–∞": "üåØ", "–ú–∞–Ω–≥–∞–ª": "üî•", "–ö–µ–±–∞–±": "üç¢", "–§–∞—Å—Ç—Ñ—É–¥": "üçü", "–ù–∞–ø–∏—Ç–∫–∏": "ü•§" },
    products: [], // –ë—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –Ω–∏–∂–µ
    csvUrl: "https://docs.google.com/spreadsheets/d/12Rmf7vVCxtQXkS4g3GCBL1xCgAfu4a23iTYuJfQLWSg/edit?usp=sharing"
  },
  tonoyan_sity: {
    name: "Tonoyan City",
    icon: "üõí",
    // –°—Å—ã–ª–∫–∞ –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø –∏–∑ –≤–∞—à–µ–π –ø–∞–ø–∫–∏ Tonoyan_Sity
    logo: "https://drive.google.com/uc?export=download&id=11CdQu7IUJQTDSNgwCj6grFDtTMHK1jSZ",
    categories: { "–ü—Ä–æ–¥—É–∫—Ç—ã": "üçû", "–û–≤–æ—â–∏": "üçé", "–ù–∞–ø–∏—Ç–∫–∏": "üçæ" },
    products: [], 
    csvUrl: "https://docs.google.com/spreadsheets/d/e/2PACX-1vR6x_J6v8pWv-T0oQ9K2C5Y0V7L_U0_q6m6v_R4kK6yQ_w/pub?gid=123456789&output=csv" // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ CSV –ª–∏—Å—Ç –¢–æ–Ω–æ—è–Ω–∞
  }
};

// –≠–¢–ê –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ò–¢ –í–°–Å –°–ê–ú–ê
async function loadAllData() {
  for (let key in stores) {
    try {
      const response = await fetch(stores[key].csvUrl);
      const data = await response.text();
      const rows = data.split('\n').slice(1);

      stores[key].products = rows.map(row => {
        const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
        if (cols.length < 5) return null;

        let imgId = "";
        const match = cols[1].match(/id=([^"&]+)/);
        if (match) imgId = `https://drive.google.com/uc?export=download&id=${match[1]}`;

        return {
          category: cols[0].replace(/"/g, '').trim(),
          img: imgId || "https://via.placeholder.com/80",
          name: cols[2].replace(/"/g, '').trim() || cols[3].replace(/"/g, '').trim(),
          desc: cols[4].replace(/"/g, '').trim(),
          price: parseInt(cols[5].replace(/[^0-9]/g, '')) || 0
        };
      }).filter(p => p !== null);
    } catch (e) {
      console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞ " + key);
    }
  }


}

/* ----------------------------------------------------------- */
/* ---------------- –°–û–°–¢–û–Ø–ù–ò–ï ---------------- */
let currentStore = null;
let currentCategory = null;
let carts = {};

/* ---------------- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---------------- */
function hideAllPages() {
  document.getElementById('home-page').classList.add('hidden');
  document.getElementById('store-page').classList.add('hidden');
}

function goHome() {
  hideAllPages();
  document.getElementById('home-page').classList.remove('hidden');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function goBack() {
  if (currentCategory) openStore(currentStore);
  else if (currentStore) goHome();
  else goHome();
}

/* ---------------- –ú–ê–ì–ê–ó–ò–ù–´ ---------------- */
function renderShops() {
  const container = document.getElementById('shops-list');
  container.innerHTML = '';

  Object.keys(stores).forEach(key => {
    const div = document.createElement('div');
    div.className = 'card';

    if (stores[key].logo) {
      div.innerHTML = `
        <img src="${stores[key].logo}" alt="${stores[key].name}">
        <div>${stores[key].name}</div>
      `;
    } else {
      div.innerHTML = `<div>${stores[key].name}</div>`;
    }

    div.onclick = () => openStore(key);
    container.appendChild(div);
  });
}

function openStore(storeKey) {
  currentStore = storeKey;
  currentCategory = null;

  hideAllPages();
  document.getElementById('store-page').classList.remove('hidden');

  document.getElementById('store-').innerText = stores[storeKey].name;

  const container = document.getElementById('store-products');
  container.innerHTML = '';

  const backBtn = document.createElement('button');
  backBtn.className = 'back-btn';
  backBtn.innerText = '‚Üê –ù–∞–∑–∞–¥';
  backBtn.onclick = goHome;
  container.appendChild(backBtn);

  const categories = [...new Set(stores[storeKey].products.map(p => p.category))];

  categories.forEach(category => {
    const div = document.createElement('div');
    div.className = 'card';

    if (stores[storeKey].categories && stores[storeKey].categories[category]) {
      div.innerHTML = `
        <span class="icon">${stores[storeKey].categories[category].icon}</span>
        <div>${category}</div>
      `;
    } else {
      div.innerHTML = `<div>${category}</div>`;
    }

    div.onclick = () => openStoreCategory(storeKey, category);
    container.appendChild(div);
  });

  document.getElementById('store-cart').classList.add('hidden');
}

function openStoreCategory(storeKey, categoryName) {
  currentStore = storeKey;
  currentCategory = categoryName;

  const container = document.getElementById('store-products');
  container.innerHTML = '';

  const backBtn = document.createElement('button');
  backBtn.className = 'back-btn';
  backBtn.innerText = '‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º';
  backBtn.onclick = () => openStore(storeKey);
  container.appendChild(backBtn);

  const products = stores[storeKey].products.filter(p => p.category === categoryName);

  products.forEach(product => {
    const div = document.createElement('div');
    div.className = 'product';

    const safeName = jsSafe(product.name);

    div.innerHTML = `
      <div style="display:flex; gap:12px; align-items:center;">
        <img src="https://via.placeholder.com/60" alt="${product.name}">
        <div>
          <h4>${product.name}</h4>
          <p>${product.price} AMD</p>
        </div>
      </div>
      <div class="qty-controls" onclick="event.stopPropagation()">
        <button onclick="changeQty('${storeKey}', '${safeName}', -1)">‚àí</button>
        <span class="qty-number" id="${qtyId(storeKey, product.name)}">0</span>
        <button onclick="changeQty('${storeKey}', '${safeName}', 1)">+</button>
      </div>
    `;

    container.appendChild(div);
  });

  document.getElementById('store-cart').classList.remove('hidden');
  renderStoreCart(storeKey);
}

/* ---------------- –ö–û–†–ó–ò–ù–ê ---------------- */
function changeQty(storeKey, productNameSafe, delta) {
  const productName = decodeSafe(productNameSafe);

  if (!carts[storeKey]) carts[storeKey] = {};
  if (!carts[storeKey][productName]) carts[storeKey][productName] = 0;

  carts[storeKey][productName] += delta;
  if (carts[storeKey][productName] < 0) carts[storeKey][productName] = 0;

  const el = document.getElementById(qtyId(storeKey, productName));
  if (el) el.innerText = carts[storeKey][productName];

  renderStoreCart(storeKey);
  renderGlobalCart();
}

function renderStoreCart(storeKey) {
  const cartDiv = document.getElementById('store-cart-items');
  const totalDiv = document.getElementById('store-cart-total');
  cartDiv.innerHTML = '';

  let total = 0;

  if (carts[storeKey]) {
    Object.keys(carts[storeKey]).forEach(productName => {
      const qty = carts[storeKey][productName];
      if (qty > 0) {
        const product = stores[storeKey].products.find(p => p.name === productName);
        if (!product) return;
        const price = product.price * qty;
        total += price;

        const item = document.createElement('div');
        item.className = 'cart-item';
        item.innerHTML = `
          <div>${productName} √ó ${qty}</div>
          <span>${price} AMD</span>
          <button onclick="removeFromCart('${storeKey}', '${jsSafe(productName)}')">‚úï</button>
        `;
        cartDiv.appendChild(item);
      }
    });
  }

  totalDiv.innerText = `–ò—Ç–æ–≥–æ: ${total} AMD`;
}

function removeFromCart(storeKey, productNameSafe) {
  const productName = decodeSafe(productNameSafe);

  if (carts[storeKey] && carts[storeKey][productName]) {
    carts[storeKey][productName] = 0;
    const qtyEl = document.getElementById(qtyId(storeKey, productName));
    if (qtyEl) qtyEl.innerText = 0;
    renderStoreCart(storeKey);
    renderGlobalCart();
  }
}

function renderGlobalCart() {
  const cartDiv = document.getElementById('global-cart-items');
  const totalDiv = document.getElementById('global-cart-total');
  const deliveryDiv = document.getElementById('delivery-total');
  const grandTotalDiv = document.getElementById('grand-total');
  cartDiv.innerHTML = '';

  let total = 0;

  Object.keys(carts).forEach(storeKey => {
    Object.keys(carts[storeKey]).forEach(productName => {
      const qty = carts[storeKey][productName];
      if (qty > 0) {
        const product = stores[storeKey].products.find(p => p.name === productName);
        if (!product) return;
        const price = product.price * qty;
        total += price;

        const item = document.createElement('div');
        item.className = 'cart-item';
        item.innerHTML = `
          <div>
            ${productName} √ó ${qty}
            <div style="font-size:12px; color: var(--text-muted);">${stores[storeKey].name}</div>
          </div>
          <span>${price} AMD</span>
          <button onclick="removeFromCart('${storeKey}', '${jsSafe(productName)}')">‚úï</button>
        `;
        cartDiv.appendChild(item);
      }
    });
  });

  totalDiv.innerText = `–¢–æ–≤–∞—Ä—ã: ${total} AMD`;

  const district = document.getElementById('district').value;
  let delivery = 0;
  if (district === "–ê—Ä—Ç–∏–∫") delivery = 500;
  else if (district === "–ê—Ä–∏—á") delivery = 700;
  else if (district === "–ù–æ—Ä-–ö—è–Ω–∫") delivery = 1000;
  else if (district === "–ü–µ–º–∑–∞—à–µ–Ω") delivery = 1000;

  deliveryDiv.innerText = `–î–æ—Å—Ç–∞–≤–∫–∞: ${delivery} AMD`;
  grandTotalDiv.innerText = `–ò—Ç–æ–≥–æ: ${total + delivery} AMD`;
}

/* ---------------- –ü–û–ò–°–ö ---------------- */
const searchInput = document.getElementById('searchInput');

searchInput.addEventListener('input', () => {
  const query = searchInput.value.toLowerCase().trim();
  if (!query) { goHome(); return; }

  hideAllPages();
  document.getElementById('store-page').classList.remove('hidden');

  const container = document.getElementById('store-products');
  container.innerHTML = '';

  const backBtn = document.createElement('button');
  backBtn.className = 'back-btn';
  backBtn.innerText = '‚Üê –ù–∞–∑–∞–¥';
  backBtn.onclick = goHome;
  container.appendChild(backBtn);

  Object.keys(stores).forEach(storeKey => {
    stores[storeKey].products.forEach(product => {
      if (product.name.toLowerCase().includes(query)) {
        const div = document.createElement('div');
        div.className = 'product';

        const safeName = jsSafe(product.name);

        div.innerHTML = `
          <div style="display:flex; gap:12px; align-items:center;">
            <img src="https://via.placeholder.com/60" alt="${product.name}">
            <div>
              <h4>${product.name}</h4>
              <p>${product.price} AMD</p>
              <p style="font-size:12px; color: var(--text-muted);">${stores[storeKey].name}</p>
            </div>
          </div>
          <div class="qty-controls" onclick="event.stopPropagation()">
            <button onclick="changeQty('${storeKey}', '${safeName}', -1)">‚àí</button>
            <span class="qty-number" id="${qtyId(storeKey, product.name)}">0</span>
            <button onclick="changeQty('${storeKey}', '${safeName}', 1)">+</button>
          </div>
        `;
        container.appendChild(div);

        // –ø–æ–∫–∞–∑–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ –µ—Å–ª–∏ —É–∂–µ –±—ã–ª–æ –≤ –∫–æ—Ä–∑–∏–Ω–µ
        const existing = carts?.[storeKey]?.[product.name] || 0;
        const el = document.getElementById(qtyId(storeKey, product.name));
        if (el) el.innerText = existing;
      }
    });
  });
});
    
    // === DISPATCHER (Worker) ===
const WORKER_URL = "https://artikfood-dispatcher.edulik844.workers.dev/orders"; // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ /orders
const API_KEY = "artikfood_Secret_2026!"; // –ª—É—á—à–µ –ø–æ—Ç–æ–º —É–±—Ä–∞—Ç—å –∏ —Ö—Ä–∞–Ω–∏—Ç—å –≤ Worker, –Ω–æ –ø–æ–∫–∞ –æ—Å—Ç–∞–≤—å

async function sendOrderToWorker(payload) {
  try {
    await fetch(WORKER_URL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-api-key": API_KEY
      },
      body: JSON.stringify(payload)
    });
  } catch (e) {
    console.log("Worker error:", e);
  }
}

/* ---------------- WHATSAPP ---------------- */
function sendFormToWhatsApp() {
  const name = document.getElementById('name').value;
  const phone = document.getElementById('phone').value;
  const address = document.getElementById('address').value;
  const district = document.getElementById('district').value;
  const payment = document.getElementById('payment').value;
  const comment = document.getElementById('comment').value;

  let message = `üõí *–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ ‚Äî Artik Food*%0A%0A`;
  message += `üë§ –ò–º—è: ${encodeURIComponent(name)}%0A`;
  message += `üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${encodeURIComponent(phone)}%0A`;
  message += `üìç –ê–¥—Ä–µ—Å: ${encodeURIComponent(address)}%0A`;
  message += `üèò –†–∞–π–æ–Ω: ${encodeURIComponent(district)}%0A`;
  message += `üí≥ –û–ø–ª–∞—Ç–∞: ${encodeURIComponent(payment)}%0A`;
  if (comment) message += `üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${encodeURIComponent(comment)}%0A`;
  message += `%0Aüì¶ *–¢–æ–≤–∞—Ä—ã:*%0A`;

  let total = 0;

  Object.keys(carts).forEach(storeKey => {
    Object.keys(carts[storeKey]).forEach(productName => {
      const qty = carts[storeKey][productName];
      if (qty > 0) {
        const product = stores[storeKey].products.find(p => p.name === productName);
        if (!product) return;
        const price = product.price * qty;
        total += price;
        message += `- ${encodeURIComponent(productName)} (${encodeURIComponent(stores[storeKey].name)}) √ó ${qty} = ${price} AMD%0A`;
      }
    });
  });

  let delivery = 0;
  if (district === "–ê—Ä—Ç–∏–∫") delivery = 500;
  else if (district === "–ê—Ä–∏—á") delivery = 700;
  else if (district === "–ù–æ—Ä-–ö—è–Ω–∫") delivery = 1000;
  else if (district === "–ü–µ–º–∑–∞—à–µ–Ω") delivery = 1000;

  message += `%0Aüöö –î–æ—Å—Ç–∞–≤–∫–∞: ${delivery} AMD%0A`;
  message += `üí∞ *–ò—Ç–æ–≥–æ: ${total + delivery} AMD*`;

  const whatsappNumber = "37443797727";
  const url = `https://wa.me/${whatsappNumber}?text=${message}`;
  // –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —á–µ—Ä–µ–∑ Worker
// –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —á–µ—Ä–µ–∑ Worker
  const itemsTotal = total;
  const grandTotal = total + delivery;

  sendOrderToWorker({
    createdAt: new Date().toISOString(),
    name, phone, address, district, payment, comment,
    carts,
    totals: { itemsTotal, delivery, grandTotal }
  });

  window.open(url, "_blank");
}

/* ---------------- –ê–î–ú–ò–ù–ö–ê ---------------- */
function showAdminPanel() {
  document.getElementById('admin-panel').classList.remove('hidden');
}
function hideAdminPanel() {
  document.getElementById('admin-panel').classList.add('hidden');
}

/* ---------------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---------------- */
document.addEventListener("DOMContentLoaded", async () => {
  await loadAllData();     // <- –≤–∞–∂–Ω–æ
  renderShops();
  renderGlobalCart();
});

</script>

</body>
</html>
