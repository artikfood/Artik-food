<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artik Food ‚Äî –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</title>

  <!-- PWA -->
  <meta name="theme-color" content="#2ecc71">
  <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAA1BMVEUAAACnej3aAAAASElEQVR4nO3BMQEAAADCoPVPbQ0PoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALwKcKAAAQyTtWAAAAAElFTkSuQmCC">

  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f8f8f8; color: #333; }
    header { background: #2ecc71; color: white; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
    header .logo-box { display:flex; align-items:center; gap:10px; cursor:pointer; }
    header img { height: 40px; }
    header h1 { margin: 0; font-size: 22px; }

    nav a { color: white; margin-left: 12px; text-decoration: none; font-weight: bold; font-size: 14px; }
    .lang-switch { margin-left: 12px; background:#fff; color:#2ecc71; border:none; border-radius:6px; padding:4px 8px; cursor:pointer; font-weight:bold; }

    .hero { background: #27ae60; color: white; padding: 40px 16px; text-align: center; }
    .hero h2 { font-size: 30px; margin-bottom: 10px; }
    .hero p { font-size: 17px; margin-bottom: 20px; }
    .hero button { background: white; color: #27ae60; border: none; padding: 12px 20px; font-size: 16px; border-radius: 6px; cursor: pointer; }

    .section { padding: 32px 16px; max-width: 1100px; margin: auto; }
    .section h3 { text-align: center; margin-bottom: 24px; }

    .shops, .categories { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 16px; }

    .products {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .card, .product {
      background: white;
      padding: 16px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
      cursor: pointer;
    }

    .product {
      display: flex;
      justify-content: space-between;
      align-items: center;
      text-align: left;
      gap: 10px;
    }

    .product h4 { margin: 0; font-size: 16px; }
    .product p { margin: 4px 0; font-size: 14px; }

    .product button { background: #2ecc71; color: white; border: none; padding: 6px 10px; border-radius: 6px; cursor: pointer; font-size: 14px; }

    .qty-controls { display:flex; justify-content:center; align-items:center; gap:8px; }
    .qty-controls button { width:30px; height:30px; border-radius:50%; border:none; background:#2ecc71; color:white; font-weight:bold; cursor:pointer; }
    .qty-number { min-width:20px; font-weight:bold; }

    .cart { background:white; padding:16px; border-radius:10px; max-width:500px; margin:20px auto; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .cart h4 { margin-top:0; text-align:center; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; font-size:14px; gap:8px; }
    .cart-total { font-weight:bold; margin-top:10px; text-align:center; }
    .cart button { width:100%; background:#27ae60; color:white; border:none; padding:10px; font-size:15px; border-radius:6px; cursor:pointer; margin-top:10px; }

    .order-form { background:white; padding:20px; border-radius:10px; max-width:500px; margin:auto; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .order-form input, .order-form textarea, .order-form select { width:100%; padding:10px; margin-bottom:12px; border-radius:6px; border:1px solid #ccc; font-size:14px; }
    .order-form button { width:100%; background:#27ae60; color:white; border:none; padding:12px; font-size:16px; border-radius:6px; cursor:pointer; }

    footer { background:#2ecc71; color:white; text-align:center; padding:16px; margin-top:40px; font-size:14px; }
    .hidden { display:none !important; }

    .back-btn {
      display: inline-block;
      margin-bottom: 12px;
      background: #ddd;
      color: #333;
      border: none;
      padding: 8px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
    }

    /* Floating nav */
    .floating-buttons {
      position: fixed;
      bottom: 140px;
      right: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 9999;
    }
    .floating-buttons button {
      padding: 10px 14px;
      border: none;
      border-radius: 25px;
      background: #ff6b00;
      color: #fff;
      font-size: 14px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      cursor: pointer;
    }
    .floating-buttons button:hover { background:#e65c00; }

    /* –ù–æ–≤—ã–µ –ø–ª–∞–≤–∞—é—â–∏–µ –∏–∫–æ–Ω–∫–∏ */
    .floating-icons {
      position: fixed;
      bottom: 16px;
      right: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 9999;
    }

    .floating-icons a {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      font-size: 18px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: transform 0.2s;
    }

    .floating-icons a:hover {
      transform: scale(1.1);
    }

    .floating-icons .whatsapp-icon {
      background: #25D366;
      color: white;
    }

    .floating-icons .telegram-icon {
      background: #0088cc;
      color: white;
    }

    .floating-icons .cart-icon {
      background: #2ecc71;
      color: white;
      font-size: 16px;
    }

    /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
    #admin-panel {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      z-index: 10001;
      overflow-y: auto;
      display: none;
    }

    #admin-panel:not(.hidden) {
      display: block !important;
    }

    .admin-card {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border: 1px solid #ddd;
      margin-bottom: 20px;
    }

    .admin-card h4 {
      margin-top: 0;
      color: #2c3e50;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
    }

    .admin-card button {
      background: #3498db;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
    }

    .admin-card button:hover {
      background: #2980b9;
    }

    /* –¢–∞–±–ª–∏—Ü—ã –≤ –∞–¥–º–∏–Ω–∫–µ */
    .admin-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
    }

    .admin-table th, .admin-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    .admin-table th {
      background: #2c3e50;
      color: white;
    }

    .admin-table tr:nth-child(even) {
      background: #f9f9f9;
    }

    /* –ü–æ–∏—Å–∫ */
    .search-box {
      margin: 20px auto;
      max-width: 500px;
      text-align: center;
    }

    .search-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #ddd;
      border-radius: 25px;
      font-size: 16px;
      outline: none;
      transition: border-color 0.3s;
    }

    .search-input:focus {
      border-color: #2ecc71;
    }

    .search-results {
      margin-top: 20px;
    }

    .search-item {
      background: white;
      padding: 12px;
      margin-bottom: 8px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      cursor: pointer;
    }

    .search-item:hover {
      background: #f0fff4;
    }

    /* –ö–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–∞ */
    #admin-access-buttons {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 9999;
      display: flex;
      gap: 10px;
      flex-direction: column;
    }

    /* –ü–∞–Ω–µ–ª—å –∫—É—Ä—å–µ—Ä–∞ */
    #courier-panel {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      z-index: 1000;
      overflow-y: auto;
      padding: 20px;
    }

    /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .notification-item {
      padding: 10px;
      margin-bottom: 8px;
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .notification-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .toast-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 9999;
      max-width: 300px;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }

    .toast-notification.urgent {
      background-color: #ffcccc !important;
      border: 2px solid #e74c3c !important;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
      100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
    }

    .toast-notification strong {
      display: block;
      margin-bottom: 5px;
    }

    .toast-notification p {
      margin: 5px 0;
      font-size: 14px;
    }

    .toast-notification button {
      position: absolute;
      top: 5px;
      right: 5px;
      background: transparent;
      border: none;
      font-size: 16px;
      cursor: pointer;
      color: #999;
    }

    .toast-notification button:hover {
      color: #333;
    }
  </style>
</head>
<body>

<header>
  <div class="logo-box" onclick="goHome()">
    <img src="logo.png" alt="Artik Food">
    <h1>Artik Food</h1>
  </div>
  <nav>
    <a href="#" onclick="goHome()">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="#order">–ó–∞–∫–∞–∑–∞—Ç—å</a>
    <a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
  </nav>
</header>

<!-- –ì–õ–ê–í–ù–ê–Ø -->
<div id="home-page">

<section class="hero">
  <h2>–î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</h2>
  <p>–°–≤–µ–∂–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–æ–≤ ‚Äî –ø—Ä—è–º–æ –∫ –≤–∞—à–µ–π –¥–≤–µ—Ä–∏</p>
  <button onclick="document.getElementById('order').scrollIntoView({behavior:'smooth'});">–ó–∞–∫–∞–∑–∞—Ç—å —Å–µ–π—á–∞—Å</button>
</section>

<!-- –ü–û–ò–°–ö -->
<section class="section">
  <div class="search-box">
    <input type="text" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –º–∞–≥–∞–∑–∏–Ω–æ–≤..." id="search-input" oninput="searchProducts()">
    <div class="search-results" id="search-results" style="display:none;"></div>
  </div>
</section>

<section class="section" id="shops">
  <h3>–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç—ã</h3>
  <div class="shops" id="shops-list"></div>
</section>

<section class="section">
  <div class="cart" id="global-cart">
    <h4>–ö–æ—Ä–∑–∏–Ω–∞ (–≤—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã)</h4>
    <div id="global-cart-items"></div>
    <div class="cart-total" id="global-cart-total">–¢–æ–≤–∞—Ä—ã: 0 AMD</div>
    <div class="cart-total" id="delivery-total">–î–æ—Å—Ç–∞–≤–∫–∞: 0 AMD</div>
    <div class="cart-total" id="grand-total">–ò—Ç–æ–≥–æ: 0 AMD</div>
  </div>
</section>

</div>

<!-- –°–¢–†–ê–ù–ò–¶–ê –°–£–ü–ï–†–ú–ê–†–ö–ï–¢–ê -->
<div id="store-page" class="hidden">
  <section class="section">
    <h3 id="store-title"></h3>
    <div class="products" id="store-products"></div>

    <div class="cart hidden" id="store-cart">
      <h4>–ö–æ—Ä–∑–∏–Ω–∞ —ç—Ç–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞</h4>
      <div id="store-cart-items"></div>
      <div class="cart-total" id="store-cart-total">–ò—Ç–æ–≥–æ: 0 AMD</div>
      <button onclick="sendStoreToWhatsApp()">–ó–∞–∫–∞–∑–∞—Ç—å –∏–∑ —ç—Ç–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (WhatsApp)</button>
      <button onclick="sendStoreToTelegram()" style="background:#0088cc;">–ó–∞–∫–∞–∑–∞—Ç—å –∏–∑ —ç—Ç–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (Telegram)</button>
    </div>
  </section>
</div>

<!-- –û–§–û–†–ú–õ–ï–ù–ò–ï -->
<section class="section" id="order">
  <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
  <form class="order-form" onsubmit="event.preventDefault(); sendFormToWhatsApp();">
    <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è" required />
    <input type="tel" id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" required />
    <input type="text" id="address" placeholder="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏" required />
    <select id="district" required onchange="calculateDelivery()">
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏</option>
      <option value="–ê—Ä—Ç–∏–∫">–ê—Ä—Ç–∏–∫ ‚Äî 500 AMD</option>
      <option value="–ê—Ä–∏—á">–ê—Ä–∏—á ‚Äî 700 AMD</option>
      <option value="–ù–æ—Ä-–ö—è–Ω–∫">–ù–æ—Ä-–ö—è–Ω–∫ ‚Äî 1000 AMD</option>
      <option value="–ü–µ–º–∑–∞—à–µ–Ω">–ü–µ–º–∑–∞—à–µ–Ω ‚Äî 1000 AMD</option>
    </select>
    
    <!-- –°–ü–û–°–û–ë –û–ü–õ–ê–¢–´ -->
    <select id="payment" required style="margin-bottom:12px;">
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</option>
      <option value="–ù–∞–ª–∏—á–Ω—ã–º–∏ –∫—É—Ä—å–µ—Ä—É">üíµ –ù–∞–ª–∏—á–Ω—ã–º–∏ –∫—É—Ä—å–µ—Ä—É</option>
      <option value="IDram">üè¶ IDram</option>
      <option value="–ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω">üí≥ –ö–∞—Ä—Ç–æ–π –æ–Ω–ª–∞–π–Ω (—Å–∫–æ—Ä–æ)</option>
    </select>
    
    <textarea rows="3" id="comment" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É"></textarea>
    <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
  </form>
  
  <div style="margin-top: 30px; background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #27ae60;">
    <p style="margin: 0; font-size: 14px;"><strong>–ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–ø–ª–∞—Ç–∞:</strong></p>
    <ul style="margin: 10px 0; padding-left: 20px; font-size: 14px;">
      <li>–í—ã–±–∏—Ä–∞–µ—Ç–µ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞</li>
      <li>–ü—Ä–∏ –æ–ø–ª–∞—Ç–µ –Ω–∞–ª–∏—á–Ω—ã–º–∏ ‚Äî –ø–µ—Ä–µ–¥–∞–µ—Ç–µ –¥–µ–Ω—å–≥–∏ –∫—É—Ä—å–µ—Ä—É –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</li>
      <li>–ü—Ä–∏ –æ–Ω–ª–∞–π–Ω-–æ–ø–ª–∞—Ç–µ ‚Äî –ø–æ–ª—É—á–∞–µ—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –æ–ø–ª–∞—Ç—É –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º</li>
      <li>–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —á–µ–∫ –Ω–∞ email –∏–ª–∏ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</li>
    </ul>
  </div>
</section>

<section class="section" id="contacts">
  <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
  <div class="card" style="max-width:400px; margin:auto;">
    <p>üìû –¢–µ–ª–µ—Ñ–æ–Ω / WhatsApp: <a href="tel:+37443797727" style="color:#27ae60; font-weight:bold;">+374 43 79 77 27</a></p>
    <p>‚úàÔ∏è Telegram: @artikfood</p>
    <p>üìç –ê—Ä—Ç–∏–∫, –®–∏—Ä–∞–∫, –ê—Ä–º–µ–Ω–∏—è</p>
  </div>
</section>

<!-- –ù–æ–≤—ã–µ –ø–ª–∞–≤–∞—é—â–∏–µ –∏–∫–æ–Ω–∫–∏ -->
<div class="floating-icons">
  <a href="#order" class="cart-icon" title="–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑">üõí</a>
  <a href="https://t.me/artikfood" class="telegram-icon" target="_blank" title="Telegram">‚úàÔ∏è</a>
  <a href="https://wa.me/37443797727" class="whatsapp-icon" target="_blank" title="WhatsApp">üí¨</a>
</div>

<div class="floating-buttons">
  <button onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
  <button onclick="goHome()">üè† –ì–ª–∞–≤–Ω–∞—è</button>
</div>

<footer>
  <p>¬© 2026 Artik Food ‚Äî –î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ê—Ä—Ç–∏–∫–µ</p>
</footer>

<!-- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) -->
<div id="admin-panel" class="hidden">
  <div style="background:#2c3e50; color:white; padding:12px 16px; display:flex; justify-content:space-between; align-items:center;">
    <h3 style="margin:0;">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
    <button onclick="hideAdminPanel()" style="background:#e74c3c; color:white; border:none; padding:6px 12px; border-radius:4px; cursor:pointer;">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
  
  <div style="padding:20px; max-width:800px; margin:auto;">
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:30px;">
      <div class="admin-card">
        <h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</h4>
        <p>–ó–∞–∫–∞–∑–æ–≤: <span id="today-orders">0</span></p>
        <p>–°—É–º–º–∞: <span id="today-amount">0</span> AMD</p>
        <p>–ö—É—Ä—å–µ—Ä–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ: <span id="active-couriers">0</span></p>
      </div>
      
      <div class="admin-card">
        <h4>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
        <button onclick="addNewProduct()" style="width:100%; margin:4px 0;">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
        <button onclick="viewAllOrders()" style="width:100%; margin:4px 0;">üìã –í—Å–µ –∑–∞–∫–∞–∑—ã</button>
        <button onclick="manageCouriers()" style="width:100%; margin:4px 0;">üö¥ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞–º–∏</button>
      </div>
    </div>
    
    <div class="admin-card">
      <h4>üì¶ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h4>
      <div id="recent-orders" style="font-size:14px;">
        <p style="text-align:center; color:#777;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
      </div>
    </div>
    
    <div class="admin-card">
      <h4>üö¥ –ê–∫—Ç–∏–≤–Ω—ã–µ –∫—É—Ä—å–µ—Ä—ã</h4>
      <div id="couriers-list" style="font-size:14px;">
        <p style="text-align:center; color:#777;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤</p>
      </div>
      <button onclick="addCourier()" style="margin-top:10px;">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫—É—Ä—å–µ—Ä–∞</button>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
      <div class="admin-card">
        <h4>üö¥ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫—É—Ä—å–µ—Ä–æ–≤ <span id="courier-notif-count"></span></h4>
        <div id="courier-notifications-list" style="max-height: 300px; overflow-y: auto; font-size: 14px;">
          <p style="text-align:center; color:#777;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
        <button onclick="clearAllNotifications('courier')" style="margin-top:10px; background:#e74c3c;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
      </div>
      
      <div class="admin-card">
        <h4>üè™ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤ <span id="store-notif-count"></span></h4>
        <div id="store-notifications-list" style="max-height: 300px; overflow-y: auto; font-size: 14px;">
          <p style="text-align:center; color:#777;">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
        </div>
        <button onclick="clearAllNotifications('store')" style="margin-top:10px; background:#e74c3c;">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ</button>
      </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee; display: flex; gap: 10px; justify-content: center;">
      <button onclick="backupData()" style="padding: 12px 25px; background: #9b59b6; color: white; border: none; border-radius: 5px; cursor: pointer;">
        üíæ –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è
      </button>
    </div>
  </div>
</div>

<!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É (–±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ JS) -->
<!-- –ö–Ω–æ–ø–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ JavaScript -->

<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ JavaScript -->
<script>
/* ========== –û–°–ù–û–í–ù–´–ï –î–ê–ù–ù–´–ï –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ========== */

// –ü–∞—Ä–æ–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏
const ADMIN_PASSWORD = "artik123";

// –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
let orders = JSON.parse(localStorage.getItem('artikFoodOrders')) || [];
let couriers = JSON.parse(localStorage.getItem('artikFoodCouriers')) || [];
let notifications = JSON.parse(localStorage.getItem('artikFoodNotifications')) || {
  couriers: [],
  stores: []
};

// –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
const NOTIFICATION_TYPES = {
  NEW_ORDER: { text: 'üÜï –ù–æ–≤—ã–π –∑–∞–∫–∞–∑', priority: 1 },
  ORDER_ACCEPTED: { text: '‚úÖ –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç', priority: 2 },
  ORDER_DELIVERED: { text: 'üì¶ –ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω', priority: 2 },
  ORDER_CANCELLED: { text: '‚ùå –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω', priority: 1 },
  ASSIGNED_TO_COURIER: { text: 'üö¥ –ù–∞–∑–Ω–∞—á–µ–Ω –∫—É—Ä—å–µ—Ä—É', priority: 1 },
  PAYMENT_RECEIVED: { text: 'üí∞ –û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞', priority: 2 },
  STORE_NEW_ORDER: { text: 'üè™ –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞', priority: 1 },
  STORE_PREPARED: { text: 'üìã –ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤ –∫ –≤—ã–¥–∞—á–µ', priority: 1 },
  URGENT_ORDER: { text: 'üö® –°—Ä–æ—á–Ω—ã–π –∑–∞–∫–∞–∑', priority: 0 }
};

// –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–æ–≤
const stores = {
  million: {
    name: "Million",
    products: [
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 300, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },
      { name: "–Ø–±–ª–æ–∫–∏ 1–∫–≥", price: 400, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },
      { name: "–ë–∞–Ω–∞–Ω—ã 1–∫–≥", price: 550, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },

      { name: "–ì–æ–≤—è–¥–∏–Ω–∞ 1–∫–≥", price: 3200, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },
      { name: "–ö—É—Ä–∏—Ü–∞ 1–∫–≥", price: 1800, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },
      { name: "–†—ã–±–∞ —Å–≤–µ–∂–∞—è 1–∫–≥", price: 2600, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },

      { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 350, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },
      { name: "–°—ã—Ä 300–≥", price: 1200, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },
      { name: "–ô–æ–≥—É—Ä—Ç", price: 200, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },

      { name: "–•–ª–µ–± –±–µ–ª—ã–π", price: 200, category: "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞" },
      { name: "–õ–∞–≤–∞—à", price: 150, category: "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞" },

      { name: "–†–∏—Å 1–∫–≥", price: 600, category: "–ë–∞–∫–∞–ª–µ—è" },
      { name: "–ú–∞–∫–∞—Ä–æ–Ω—ã", price: 400, category: "–ë–∞–∫–∞–ª–µ—è" },

      { name: "–°–æ–∫ –∞–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–π", price: 450, category: "–ù–∞–ø–∏—Ç–∫–∏" },
      { name: "–ú–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è –≤–æ–¥–∞", price: 200, category: "–ù–∞–ø–∏—Ç–∫–∏" },

      { name: "–ú–æ—é—â–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ", price: 900, category: "–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è" },
      { name: "–ü–æ—Ä–æ—à–æ–∫ —Å—Ç–∏—Ä–∞–ª—å–Ω—ã–π", price: 1800, category: "–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è" },

      { name: "–®–æ–∫–æ–ª–∞–¥", price: 350, category: "–°–ª–∞–¥–æ—Å—Ç–∏" },
      { name: "–ü–µ—á–µ–Ω—å–µ", price: 250, category: "–°–ª–∞–¥–æ—Å—Ç–∏" }
    ]
  },

  mush: {
    name: "–ú’∏÷Ç’∑",
    products: [
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 280, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },
      { name: "–ü–æ–º–∏–¥–æ—Ä—ã 1–∫–≥", price: 500, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },

      { name: "–ö—É—Ä–∏—Ü–∞ 1–∫–≥", price: 1750, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },
      { name: "–†—ã–±–∞ —Å–≤–µ–∂–∞—è 1–∫–≥", price: 2550, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },

      { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 340, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },
      { name: "–°—ã—Ä 300–≥", price: 1150, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },

      { name: "–•–ª–µ–±", price: 190, category: "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞" },

      { name: "–†–∏—Å 1–∫–≥", price: 590, category: "–ë–∞–∫–∞–ª–µ—è" },

      { name: "–°–æ–∫ —è–±–ª–æ—á–Ω—ã–π", price: 430, category: "–ù–∞–ø–∏—Ç–∫–∏" },

      { name: "–ü–æ—Ä–æ—à–æ–∫ —Å—Ç–∏—Ä–∞–ª—å–Ω—ã–π", price: 1750, category: "–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è" },

      { name: "–®–æ–∫–æ–ª–∞–¥", price: 330, category: "–°–ª–∞–¥–æ—Å—Ç–∏" }
    ]
  },

  tonoyan: {
    name: "Tonoyan",
    products: [
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 310, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },
      { name: "–Ø–±–ª–æ–∫–∏ 1–∫–≥", price: 420, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },

      { name: "–ì–æ–≤—è–¥–∏–Ω–∞ 1–∫–≥", price: 3250, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },

      { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 360, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },

      { name: "–•–ª–µ–±", price: 210, category: "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞" },

      { name: "–ú–∞–∫–∞—Ä–æ–Ω—ã", price: 390, category: "–ë–∞–∫–∞–ª–µ—è" },

      { name: "–í–æ–¥–∞ –º–∏–Ω–µ—Ä–∞–ª—å–Ω–∞—è", price: 190, category: "–ù–∞–ø–∏—Ç–∫–∏" },

      { name: "–ú–æ—é—â–µ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ", price: 880, category: "–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è" },

      { name: "–ü–µ—á–µ–Ω—å–µ", price: 240, category: "–°–ª–∞–¥–æ—Å—Ç–∏" }
    ]
  },

  danielyan: {
    name: "Danielyan",
    products: [
      { name: "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å 1–∫–≥", price: 295, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },
      { name: "–ë–∞–Ω–∞–Ω—ã 1–∫–≥", price: 560, category: "–û–≤–æ—â–∏ –∏ —Ñ—Ä—É–∫—Ç—ã" },

      { name: "–ö—É—Ä–∏—Ü–∞ 1–∫–≥", price: 1780, category: "–ú—è—Å–æ –∏ —Ä—ã–±–∞" },

      { name: "–ú–æ–ª–æ–∫–æ 1–ª", price: 345, category: "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã" },

      { name: "–•–ª–µ–±", price: 195, category: "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞" },

      { name: "–†–∏—Å 1–∫–≥", price: 605, category: "–ë–∞–∫–∞–ª–µ—è" },

      { name: "–°–æ–∫", price: 440, category: "–ù–∞–ø–∏—Ç–∫–∏" },

      { name: "–ü–æ—Ä–æ—à–æ–∫ —Å—Ç–∏—Ä–∞–ª—å–Ω—ã–π", price: 1770, category: "–ë—ã—Ç–æ–≤–∞—è —Ö–∏–º–∏—è" },

      { name: "–®–æ–∫–æ–ª–∞–¥", price: 340, category: "–°–ª–∞–¥–æ—Å—Ç–∏" }
    ]
  },

  edem: {
    name: "–≠–¥–µ–º (–¶–≤–µ—Ç—ã)",
    products: [
      { name: "–†–æ–∑—ã (1 —à—Ç)", price: 500, category: "–¶–≤–µ—Ç—ã" },
      { name: "–¢—é–ª—å–ø–∞–Ω—ã (1 —à—Ç)", price: 400, category: "–¶–≤–µ—Ç—ã" },
      { name: "–ë—É–∫–µ—Ç —Ä–æ–∑", price: 5000, category: "–ë—É–∫–µ—Ç—ã" },
      { name: "–ë—É–∫–µ—Ç —Ç—é–ª—å–ø–∞–Ω–æ–≤", price: 4500, category: "–ë—É–∫–µ—Ç—ã" },
      { name: "–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –≤ –∫–æ—Ä–æ–±–∫–µ", price: 7000, category: "–ö–æ–º–ø–æ–∑–∏—Ü–∏–∏" },
      { name: "–ü–æ–¥–∞—Ä–æ—á–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞", price: 300, category: "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" }
    ]
  }
};

/* ========== –°–ò–°–¢–ï–ú–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ========== */

let currentStore = null;
let currentCategory = null;
let carts = {};
let nextCourierId = 1;

/* ========== –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò ========== */

// –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function saveNotifications() {
  localStorage.setItem('artikFoodNotifications', JSON.stringify(notifications));
}

// –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
function saveOrder(orderData) {
  const order = {
    id: Date.now(),
    ...orderData,
    date: new Date().toLocaleString(),
    status: 'new',
    courier: null
  };
  
  orders.push(order);
  localStorage.setItem('artikFoodOrders', JSON.stringify(orders));
  updateAdminStats();
}

// –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ä–æ—á–Ω–æ—Å—Ç–∏ –∑–∞–∫–∞–∑–∞
function determineIfUrgent(orderData) {
  const total = orderData.total || 0;
  const district = orderData.district || '';
  const hour = new Date().getHours();
  
  return total > 10000 || 
         district.includes('–¶–µ–Ω—Ç—Ä') || 
         (hour >= 12 && hour <= 14) || 
         (hour >= 18 && hour <= 20);
}

// –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
function calculateDelivery() {
  renderGlobalCart();
}

/* ========== –ù–ê–í–ò–ì–ê–¶–ò–Ø ========== */

function hideAllPages() {
  document.getElementById('home-page').classList.add('hidden');
  document.getElementById('store-page').classList.add('hidden');
}

function goHome() {
  hideAllPages();
  document.getElementById('home-page').classList.remove('hidden');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function goBack() {
  if (currentCategory) {
    openStore(currentStore);
  } else if (currentStore) {
    goHome();
  } else {
    goHome();
  }
}

/* ========== –ü–û–ò–°–ö –¢–û–í–ê–†–û–í ========== */

function searchProducts() {
  const searchInput = document.getElementById('search-input');
  const searchResults = document.getElementById('search-results');
  const query = searchInput.value.toLowerCase().trim();
  
  if (!query) {
    searchResults.style.display = 'none';
    return;
  }
  
  let results = [];
  
  // –ò—â–µ–º –º–∞–≥–∞–∑–∏–Ω—ã
  Object.keys(stores).forEach(storeKey => {
    const store = stores[storeKey];
    if (store.name.toLowerCase().includes(query)) {
      results.push({
        type: 'store',
        storeKey: storeKey,
        name: store.name,
        display: `üè™ ${store.name}`
      });
    }
  });
  
  // –ò—â–µ–º —Ç–æ–≤–∞—Ä—ã
  Object.keys(stores).forEach(storeKey => {
    const store = stores[storeKey];
    store.products.forEach(product => {
      if (product.name.toLowerCase().includes(query) || 
          product.category.toLowerCase().includes(query)) {
        results.push({
          type: 'product',
          storeKey: storeKey,
          product: product,
          display: `üì¶ ${product.name} - ${product.price} AMD (${store.name})`
        });
      }
    });
  });
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  if (results.length > 0) {
    searchResults.innerHTML = '';
    results.forEach(result => {
      const div = document.createElement('div');
      div.className = 'search-item';
      div.innerHTML = result.display;
      div.onclick = () => {
        if (result.type === 'store') {
          openStore(result.storeKey);
        } else {
          openStore(result.storeKey);
          // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞
          setTimeout(() => {
            openStoreCategory(result.storeKey, result.product.category);
          }, 100);
        }
        searchInput.value = '';
        searchResults.style.display = 'none';
      };
      searchResults.appendChild(div);
    });
    searchResults.style.display = 'block';
  } else {
    searchResults.innerHTML = '<div class="search-item">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
    searchResults.style.display = 'block';
  }
}

/* ========== –ú–ê–ì–ê–ó–ò–ù–´ ========== */

function renderShops() {
  const container = document.getElementById('shops-list');
  container.innerHTML = '';

  Object.keys(stores).forEach(key => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerText = stores[key].name;
    div.onclick = () => openStore(key);
    container.appendChild(div);
  });
}

function openStore(storeKey) {
  currentStore = storeKey;
  currentCategory = null;

  hideAllPages();
  document.getElementById('store-page').classList.remove('hidden');

  document.getElementById('store-title').innerText = stores[storeKey].name;

  const container = document.getElementById('store-products');
  container.innerHTML = '';

  const backBtn = document.createElement('button');
  backBtn.className = 'back-btn';
  backBtn.innerText = '‚Üê –ù–∞–∑–∞–¥';
  backBtn.onclick = goHome;
  container.appendChild(backBtn);

  const categories = [...new Set(stores[storeKey].products.map(p => p.category))];

  categories.forEach(category => {
    const div = document.createElement('div');
    div.className = 'card';
    div.innerText = category;
    div.onclick = () => openStoreCategory(storeKey, category);
    container.appendChild(div);
  });

  document.getElementById('store-cart').classList.add('hidden');
}

function openStoreCategory(storeKey, categoryName) {
  currentStore = storeKey;
  currentCategory = categoryName;

  const container = document.getElementById('store-products');
  container.innerHTML = '';

  const backBtn = document.createElement('button');
  backBtn.className = 'back-btn';
  backBtn.innerText = '‚Üê –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º';
  backBtn.onclick = () => openStore(storeKey);
  container.appendChild(backBtn);

  const list = document.createElement('div');
  list.className = 'products';

  stores[storeKey].products.forEach(item => {
    if (item.category === categoryName) {
      const safeId = item.name.replace(/\s+/g,'');
      const qty = carts[storeKey]?.[item.name]?.qty || 0;

      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <div>
          <h4>${item.name}</h4>
          <p>${item.price} AMD</p>
        </div>
        <div class="qty-controls">
          <button onclick="changeQty('${storeKey}', '${item.name}', ${item.price}, -1)">‚àí</button>
          <span class="qty-number" id="qty-${storeKey}-${safeId}">${qty}</span>
          <button onclick="changeQty('${storeKey}', '${item.name}', ${item.price}, 1)">+</button>
        </div>
      `;
      list.appendChild(div);
    }
  });

  container.appendChild(list);
  document.getElementById('store-cart').classList.remove('hidden');
}

/* ========== –ö–û–†–ó–ò–ù–ê ========== */

function changeQty(storeKey, productName, price, delta) {
  if (!carts[storeKey]) carts[storeKey] = {};
  if (!carts[storeKey][productName]) carts[storeKey][productName] = { qty: 0, price };

  carts[storeKey][productName].qty += delta;
  if (carts[storeKey][productName].qty < 0) carts[storeKey][productName].qty = 0;

  const safeId = productName.replace(/\s+/g,'');
  const qtyEl = document.getElementById(`qty-${storeKey}-${safeId}`);
  if (qtyEl) qtyEl.innerText = carts[storeKey][productName].qty;

  updateStoreCart();
  renderGlobalCart();
}

// –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
function removeItemFromCart(storeKey, productName) {
  if (!carts[storeKey] || !carts[storeKey][productName]) return;
  
  if (confirm(`–£–¥–∞–ª–∏—Ç—å "${productName}" –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?`)) {
    delete carts[storeKey][productName];
    
    // –ï—Å–ª–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ–ª—å—à–µ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤, —É–¥–∞–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
    if (Object.keys(carts[storeKey]).length === 0) {
      delete carts[storeKey];
    }
    
    updateStoreCart();
    renderGlobalCart();
  }
}

function updateStoreCart() {
  const cartBox = document.getElementById('store-cart');
  const itemsBox = document.getElementById('store-cart-items');
  const totalBox = document.getElementById('store-cart-total');

  itemsBox.innerHTML = '';
  let total = 0;

  Object.entries(carts[currentStore] || {}).forEach(([name, data]) => {
    if (data.qty > 0) {
      const div = document.createElement('div');
      div.className = 'cart-item';
      div.innerHTML = `
        <span>${name} √ó ${data.qty}</span>
        <span>${data.qty * data.price} AMD</span>
        <button onclick="removeItemFromCart('${currentStore}', '${name}')" style="color:red; margin-left:8px;">√ó</button>
      `;
      itemsBox.appendChild(div);
      total += data.qty * data.price;
    }
  });

  totalBox.innerText = `–ò—Ç–æ–≥–æ: ${total} AMD`;
  cartBox.classList.toggle('hidden', total === 0);
}

function renderGlobalCart() {
  const container = document.getElementById('global-cart-items');
  container.innerHTML = '';

  let goodsTotal = 0;

  Object.keys(carts).forEach(storeKey => {
    Object.entries(carts[storeKey]).forEach(([name, data]) => {
      if (data.qty > 0) {
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <span>${stores[storeKey].name}: ${name} √ó ${data.qty}</span>
          <span>${data.qty * data.price} AMD</span>
          <button onclick="removeItemFromCart('${storeKey}', '${name}')" style="color:red; margin-left:8px;">√ó</button>
        `;
        container.appendChild(div);
        goodsTotal += data.qty * data.price;
      }
    });
  });

  document.getElementById('global-cart-total').innerText = `–¢–æ–≤–∞—Ä—ã: ${goodsTotal} AMD`;

  const district = document.getElementById('district')?.value;
  let delivery = 0;
  if (district === "–ê—Ä—Ç–∏–∫") delivery = 500;
  else if (district === "–ê—Ä–∏—á") delivery = 700;
  else if (district === "–ù–æ—Ä-–ö—è–Ω–∫") delivery = 1000;
  else if (district === "–ü–µ–º–∑–∞—à–µ–Ω") delivery = 1000;

  document.getElementById('delivery-total').innerText = `–î–æ—Å—Ç–∞–≤–∫–∞: ${delivery} AMD`;
  document.getElementById('grand-total').innerText = `–ò—Ç–æ–≥–æ: ${goodsTotal + delivery} AMD`;
}

/* ========== –ó–ê–ö–ê–ó–´ ========== */

function sendFormToWhatsApp() {
  const name = document.getElementById('name').value;
  const phone = document.getElementById('phone').value;
  const address = document.getElementById('address').value;
  const district = document.getElementById('district').value;
  const payment = document.getElementById('payment').value;
  const comment = document.getElementById('comment').value;

  let text = `üõí –ù–æ–≤—ã–π –∑–∞–∫–∞–∑ Artik Food%0A%0A`;
  text += `üë§ –ò–º—è: ${name}%0A`;
  text += `üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}%0A`;
  text += `üìç –ê–¥—Ä–µ—Å: ${address} (${district})%0A`;
  text += `üí≥ –û–ø–ª–∞—Ç–∞: ${payment}%0A`;
  if (comment) text += `üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${comment}%0A`;
  text += `%0Aüì¶ –¢–æ–≤–∞—Ä—ã:%0A`;

  let goodsTotal = 0;
  Object.keys(carts).forEach(storeKey => {
    Object.entries(carts[storeKey]).forEach(([name, data]) => {
      if (data.qty > 0) {
        text += `- ${stores[storeKey].name}: ${name} √ó ${data.qty} = ${data.qty * data.price} AMD%0A`;
        goodsTotal += data.qty * data.price;
      }
    });
  });

  const delivery = district === "–ê—Ä—Ç–∏–∫" ? 500 : 
                   district === "–ê—Ä–∏—á" ? 700 : 
                   district === "–ù–æ—Ä-–ö—è–Ω–∫" ? 1000 : 
                   district === "–ü–µ–º–∑–∞—à–µ–Ω" ? 1000 : 0;
  const total = goodsTotal + delivery;
  
  text += `%0Aüí∞ –ò—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä—ã: ${goodsTotal} AMD%0A`;
  text += `üöö –î–æ—Å—Ç–∞–≤–∫–∞: ${delivery} AMD%0A`;
  text += `üíµ –ö –æ–ø–ª–∞—Ç–µ: ${total} AMD%0A%0A`;
  text += `_–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ —Å–∞–π—Ç_`;

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–∫–∞–∑
  const orderId = Date.now();
  const orderData = {
    name, phone, address, district, payment, comment,
    items: JSON.parse(JSON.stringify(carts)),
    total: total,
    delivery: delivery
  };
  
  saveOrder({
    ...orderData,
    id: orderId
  });

  // ===== –û–¢–ü–†–ê–í–õ–Ø–ï–ú –£–õ–£–ß–®–ï–ù–ù–´–ï –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø =====
  
  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ä–æ—á–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞
  const isUrgentOrder = determineIfUrgent(orderData);
  
  // 1. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ –≤ –∑–∞–∫–∞–∑–µ
  Object.keys(carts).forEach(storeKey => {
    sendNotification(
      'STORE_NEW_ORDER',
      'store',
      orderId,
      `–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ #${orderId} –≤ –º–∞–≥–∞–∑–∏–Ω ${stores[storeKey].name} –Ω–∞ —Å—É–º–º—É ${total} AMD`,
      isUrgentOrder
    );
  });
  
  // 2. –û–±—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è –∫—É—Ä—å–µ—Ä–æ–≤
  sendNotification(
    'NEW_ORDER',
    'courier',
    orderId,
    `–ù–æ–≤—ã–π –∑–∞–∫–∞–∑ #${orderId} –Ω–∞ —Å—É–º–º—É ${total} AMD. –ê–¥—Ä–µ—Å: ${address} (${district}). –û–ø–ª–∞—Ç–∞: ${payment}`,
    isUrgentOrder
  );
  
  // 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫—É
  sendNotification(
    'NEW_ORDER',
    'courier', // –∞–¥–º–∏–Ω—É —Ç–æ–∂–µ –∫–∞–∫ –∫—É—Ä—å–µ—Ä—É
    orderId,
    `–ó–∞–∫–∞–∑ #${orderId} –æ—Ç ${name}. –¢–µ–ª–µ—Ñ–æ–Ω: ${phone}. –°—É–º–º–∞: ${total} AMD`,
    isUrgentOrder
  );
  // ================================

  window.open(`https://wa.me/37443797727?text=${text}`, '_blank');
  
  // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É –ø–æ—Å–ª–µ –∑–∞–∫–∞–∑–∞
  carts = {};
  renderGlobalCart();
  if (currentStore) updateStoreCart();
  document.getElementById('order-form').reset();
  
  alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –û–∂–∏–¥–∞–π—Ç–µ –∑–≤–æ–Ω–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.');
}

function sendStoreToWhatsApp() {
  let text = `üõí –ó–∞–∫–∞–∑ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ ${stores[currentStore].name}%0A%0A`;
  let total = 0;

  Object.entries(carts[currentStore]).forEach(([name, data]) => {
    if (data.qty > 0) {
      text += `- ${name} √ó ${data.qty} = ${data.qty * data.price} AMD%0A`;
      total += data.qty * data.price;
    }
  });

  text += `%0Aüí∞ –ò—Ç–æ–≥–æ: ${total} AMD%0A`;
  text += `_–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ —Å–∞–π—Ç_`;

  window.open(`https://wa.me/37443797727?text=${text}`, '_blank');
}

function sendStoreToTelegram() {
  let text = `üõí –ó–∞–∫–∞–∑ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ ${stores[currentStore].name}\n\n`;
  let total = 0;

  Object.entries(carts[currentStore]).forEach(([name, data]) => {
    if (data.qty > 0) {
      text += `- ${name} √ó ${data.qty} = ${data.qty * data.price} AMD\n`;
      total += data.qty * data.price;
    }
  });

  text += `\nüí∞ –ò—Ç–æ–≥–æ: ${total} AMD\n`;
  text += `_–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —á–µ—Ä–µ–∑ —Å–∞–π—Ç_`;

  window.open(`https://t.me/share/url?url=&text=${encodeURIComponent(text)}`, '_blank');
}

/* ========== –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô ========== */

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function updateNotificationCounters() {
  const unreadCourier = notifications.couriers.filter(n => !n.read).length;
  const unreadStore = notifications.stores.filter(n => !n.read).length;
  
  const courierCounter = document.getElementById('courier-notif-count');
  const storeCounter = document.getElementById('store-notif-count');
  
  if (courierCounter) {
    courierCounter.textContent = unreadCourier > 0 ? ` (${unreadCourier})` : '';
  }
  if (storeCounter) {
    storeCounter.textContent = unreadStore > 0 ? ` (${unreadStore})` : '';
  }
}

// –û—Ç–º–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
function markAsRead(notificationId, target) {
  const list = target === 'courier' ? notifications.couriers : notifications.stores;
  const notification = list.find(n => n.id === notificationId);
  
  if (notification) {
    notification.read = true;
    saveNotifications();
    updateNotificationCounters();
    return true;
  }
  return false;
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–º–µ—Ç–∫–∏ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º (–¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π)
function markNotificationAsRead(id, target, event) {
  if (event) event.stopPropagation();
  if (markAsRead(id, target)) {
    if (target === 'courier') {
      showCourierNotifications();
    } else {
      showStoreNotifications();
    }
  }
}

// –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function clearAllNotifications(target) {
  if (confirm(`–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è ${target === 'courier' ? '–∫—É—Ä—å–µ—Ä–æ–≤' : '–º–∞–≥–∞–∑–∏–Ω–æ–≤'}?`)) {
    if (target === 'courier') {
      notifications.couriers = [];
    } else {
      notifications.stores = [];
    }
    saveNotifications();
    updateNotificationCounters();
    
    if (target === 'courier') {
      showCourierNotifications();
    } else {
      showStoreNotifications();
    }
  }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function autoCleanupNotifications() {
  const MAX_NOTIFICATIONS_PER_TYPE = 100;
  const DAYS_TO_KEEP = 7;
  const now = new Date();
  
  const cleanupList = (list) => {
    const recent = list.filter(notification => {
      const notificationDate = new Date(notification.timestamp);
      const diffDays = (now - notificationDate) / (1000 * 60 * 60 * 24);
      return diffDays <= DAYS_TO_KEEP;
    });
    return recent.slice(-MAX_NOTIFICATIONS_PER_TYPE);
  };
  
  notifications.couriers = cleanupList(notifications.couriers);
  notifications.stores = cleanupList(notifications.stores);
  
  saveNotifications();
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function sendNotification(typeKey, target, orderId, details = '', isUrgent = false) {
  const notificationType = isUrgent ? NOTIFICATION_TYPES.URGENT_ORDER : NOTIFICATION_TYPES[typeKey];
  
  if (!notificationType) {
    console.error('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', typeKey);
    return;
  }
  
  const notification = {
    id: Date.now(),
    type: notificationType.text,
    priority: notificationType.priority,
    target: target,
    orderId: orderId,
    details: details,
    timestamp: new Date().toLocaleString(),
    read: false,
    urgent: isUrgent
  };
  
  // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  if (notification.priority <= 1) {
    if (target === 'courier') {
      notifications.couriers.unshift(notification);
    } else if (target === 'store') {
      notifications.stores.unshift(notification);
    }
  } else {
    if (target === 'courier') {
      notifications.couriers.push(notification);
    } else if (target === 'store') {
      notifications.stores.push(notification);
    }
  }
  
  saveNotifications();
  
  // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
  playNotificationSound(isUrgent);
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
  if (isUrgent) {
    showUrgentToast(notification.type, details);
  } else {
    showToastNotification(notification.type, details);
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
  updateNotificationCounters();
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω–∫–µ
  if (document.getElementById('admin-panel') && 
      !document.getElementById('admin-panel').classList.contains('hidden')) {
    if (target === 'courier') {
      showCourierNotifications();
    } else {
      showStoreNotifications();
    }
  }
}

// –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function playNotificationSound(isUrgent) {
  try {
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    if (isUrgent) {
      // –°—Ä–æ—á–Ω—ã–π –∑–≤—É–∫ (–≤—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞, 3 —Å–∏–≥–Ω–∞–ª–∞)
      for (let i = 0; i < 3; i++) {
        setTimeout(() => {
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);
          
          oscillator.frequency.value = 1200;
          oscillator.type = 'sine';
          
          gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
          
          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.2);
        }, i * 250);
      }
    } else {
      // –û–±—ã—á–Ω—ã–π –∑–≤—É–∫
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.frequency.value = 800;
      oscillator.type = 'sine';
      
      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
      
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + 0.5);
    }
  } catch (error) {
    console.log('–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è');
  }
}

// –°—Ä–æ—á–Ω–æ–µ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
function showUrgentToast(type, message) {
  const toast = document.createElement('div');
  toast.className = 'toast-notification urgent';
  toast.innerHTML = `
    <strong style="color: #e74c3c;">${type}</strong>
    <p>${message}</p>
    <button onclick="this.parentElement.remove()">‚úï</button>
  `;
  
  document.body.appendChild(toast);
  
  // –ú–∏–≥–∞–Ω–∏–µ –¥–ª—è —Å—Ä–æ—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  let blinkCount = 0;
  const blinkInterval = setInterval(() => {
    toast.style.backgroundColor = blinkCount % 2 === 0 ? '#ffeaa7' : '#ffcccc';
    blinkCount++;
    if (blinkCount >= 6) {
      clearInterval(blinkInterval);
      toast.style.backgroundColor = '#ffcccc';
    }
  }, 500);
  
  setTimeout(() => {
    if (toast.parentElement) {
      toast.remove();
    }
  }, 10000);
}

// –û–±—ã—á–Ω–æ–µ –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
function showToastNotification(type, message) {
  const toast = document.createElement('div');
  toast.className = 'toast-notification';
  toast.innerHTML = `
    <strong>${type}</strong>
    <p>${message}</p>
    <button onclick="this.parentElement.remove()">‚úï</button>
  `;
  
  document.body.appendChild(toast);
  
  // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
  toast.style.animation = 'slideIn 0.3s ease';
  
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
  setTimeout(() => {
    if (toast.parentElement) {
      toast.style.animation = 'slideOut 0.3s ease forwards';
      setTimeout(() => {
        if (toast.parentElement) {
          toast.remove();
        }
      }, 300);
    }
  }, 5000);
}

// –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function createNotificationElement(notification, target) {
  const div = document.createElement('div');
  div.className = 'notification-item';
  div.style.padding = '10px';
  div.style.marginBottom = '8px';
  div.style.background = notification.read ? '#f8f9fa' : 
                        notification.urgent ? '#ffcccc' : '#fff3cd';
  div.style.border = notification.read ? '1px solid #ddd' : 
                    notification.urgent ? '2px solid #e74c3c' : '1px solid #ffeaa7';
  div.style.borderRadius = '6px';
  div.style.cursor = 'pointer';
  div.style.position = 'relative';
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞
  const priorityColor = notification.priority === 0 ? '#e74c3c' : 
                       notification.priority === 1 ? '#f39c12' : '#3498db';
  
  div.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: start;">
      <div style="flex: 1; position: relative; padding-left: 8px; border-left: 3px solid ${priorityColor}">
        <strong>${notification.type}</strong>
        <p style="margin: 5px 0 0 0; font-size: 13px; color: #666;">
          ${notification.details}
        </p>
        <small style="color: #999;">${notification.timestamp}</small>
        ${notification.urgent ? '<span style="color: #e74c3c; font-size: 10px; margin-left: 5px;">üö® –°–†–û–ß–ù–û</span>' : ''}
      </div>
      ${!notification.read ? 
        `<button onclick="markNotificationAsRead(${notification.id}, '${target}', event)" 
                style="background: #3498db; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 12px; cursor: pointer; white-space: nowrap;">
          –ü—Ä–æ—á–∏—Ç–∞–Ω–æ
        </button>` : 
        '<span style="color: #27ae60; font-size: 12px; white-space: nowrap;">‚úì –ü—Ä–æ—á–∏—Ç–∞–Ω–æ</span>'
      }
    </div>
  `;
  
  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
  div.onclick = (e) => {
    if (e.target.tagName !== 'BUTTON') {
      markNotificationAsRead(notification.id, target, e);
    }
  };
  
  return div;
}

// –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫—É—Ä—å–µ—Ä–æ–≤
function showCourierNotifications() {
  const container = document.getElementById('courier-notifications-list');
  if (!container) return;
  
  container.innerHTML = '';
  
  const unread = notifications.couriers.filter(n => !n.read);
  const read = notifications.couriers.filter(n => n.read).slice(-10);
  
  if (unread.length === 0 && read.length === 0) {
    container.innerHTML = '<p style="text-align:center; color:#777;">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>';
    return;
  }
  
  // –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
  if (unread.length > 0) {
    const heading = document.createElement('h5');
    heading.textContent = '–ù–æ–≤—ã–µ';
    heading.style.color = '#e74c3c';
    heading.style.marginTop = '15px';
    container.appendChild(heading);
    
    unread.forEach(notification => {
      const div = createNotificationElement(notification, 'courier');
      container.appendChild(div);
    });
  }
  
  // –ü—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
  if (read.length > 0) {
    const heading = document.createElement('h5');
    heading.textContent = '–†–∞–Ω–µ–µ';
    heading.style.color = '#7f8c8d';
    heading.style.marginTop = '15px';
    container.appendChild(heading);
    
    read.forEach(notification => {
      const div = createNotificationElement(notification, 'courier');
      div.style.opacity = '0.7';
      container.appendChild(div);
    });
  }
}

// –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–æ–≤
function showStoreNotifications() {
  const container = document.getElementById('store-notifications-list');
  if (!container) return;
  
  container.innerHTML = '';
  
  const unread = notifications.stores.filter(n => !n.read);
  const read = notifications.stores.filter(n => n.read).slice(-10);
  
  if (unread.length === 0 && read.length === 0) {
    container.innerHTML = '<p style="text-align:center; color:#777;">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>';
    return;
  }
  
  // –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
  if (unread.length > 0) {
    const heading = document.createElement('h5');
    heading.textContent = '–ù–æ–≤—ã–µ';
    heading.style.color = '#e74c3c';
    heading.style.marginTop = '15px';
    container.appendChild(heading);
    
    unread.forEach(notification => {
      const div = createNotificationElement(notification, 'store');
      container.appendChild(div);
    });
  }
  
  // –ü—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
  if (read.length > 0) {
    const heading = document.createElement('h5');
    heading.textContent = '–†–∞–Ω–µ–µ';
    heading.style.color = '#7f8c8d';
    heading.style.marginTop = '15px';
    container.appendChild(heading);
    
    read.forEach(notification => {
      const div = createNotificationElement(notification, 'store');
      div.style.opacity = '0.7';
      container.appendChild(div);
    });
  }
}

/* ========== –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ ========== */

function showAdminLogin() {
  const password = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:");
  if (password === ADMIN_PASSWORD) {
    showAdminPanel();
  } else if (password) {
    alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å");
  }
}

function showAdminPanel() {
  // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–∞
  const accessButtons = document.getElementById('admin-access-buttons');
  if (accessButtons) {
    accessButtons.style.display = 'none';
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∞
  const adminPanel = document.getElementById('admin-panel');
  if (adminPanel) {
    adminPanel.classList.remove('hidden');
    adminPanel.style.display = 'block';
  }
  
  updateAdminStats();
}

function hideAdminPanel() {
  const adminPanel = document.getElementById('admin-panel');
  if (adminPanel) {
    adminPanel.classList.add('hidden');
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–∞
  const accessButtons = document.getElementById('admin-access-buttons');
  if (accessButtons) {
    accessButtons.style.display = 'flex';
  }
}

function updateAdminStats() {
  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
  const today = new Date().toDateString();
  const todayOrders = orders.filter(order => 
    new Date(order.date).toDateString() === today
  );
  
  const todayOrdersElem = document.getElementById('today-orders');
  const todayAmountElem = document.getElementById('today-amount');
  const activeCouriersElem = document.getElementById('active-couriers');
  
  if (todayOrdersElem) {
    todayOrdersElem.textContent = todayOrders.length;
  }
  if (todayAmountElem) {
    todayAmountElem.textContent = todayOrders.reduce((sum, order) => sum + order.total, 0);
  }
  if (activeCouriersElem) {
    activeCouriersElem.textContent = couriers.filter(c => c.status === 'active').length;
  }
  
  // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã
  const recentOrdersContainer = document.getElementById('recent-orders');
  if (recentOrdersContainer) {
    recentOrdersContainer.innerHTML = '';
    
    const lastOrders = orders.slice(-5).reverse();
    lastOrders.forEach(order => {
      const div = document.createElement('div');
      div.style.padding = '8px';
      div.style.borderBottom = '1px solid #eee';
      div.innerHTML = `
        <strong>${order.name}</strong> ‚Äî ${order.total} AMD<br>
        <small>${order.address} ‚Ä¢ ${order.date}</small>
      `;
      recentOrdersContainer.appendChild(div);
    });
    
    if (lastOrders.length === 0) {
      recentOrdersContainer.innerHTML = '<p style="text-align:center; color:#777;">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>';
    }
  }
  
  // –°–ø–∏—Å–æ–∫ –∫—É—Ä—å–µ—Ä–æ–≤
  const couriersContainer = document.getElementById('couriers-list');
  if (couriersContainer) {
    couriersContainer.innerHTML = '';
    
    couriers.forEach(courier => {
      const div = document.createElement('div');
      div.style.padding = '8px';
      div.style.borderBottom = '1px solid #eee';
      div.style.display = 'flex';
      div.style.justifyContent = 'space-between';
      div.innerHTML = `
        <div>
          <strong>${courier.name}</strong><br>
          <small>üì± ${courier.phone} ‚Ä¢ ${courier.status === 'active' ? 'üü¢ –ê–∫—Ç–∏–≤–µ–Ω' : 'üî¥ –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</small>
        </div>
        <button onclick="toggleCourierStatus(${courier.id})" style="font-size:12px;">
          ${courier.status === 'active' ? '–î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å' : '–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å'}
        </button>
      `;
      couriersContainer.appendChild(div);
    });
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  showCourierNotifications();
  showStoreNotifications();
  updateNotificationCounters();
}

// –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—å–µ—Ä–∞–º–∏
function addCourier() {
  const name = prompt("–ò–º—è –∫—É—Ä—å–µ—Ä–∞:");
  if (!name) return;
  
  const phone = prompt("–¢–µ–ª–µ—Ñ–æ–Ω –∫—É—Ä—å–µ—Ä–∞:");
  if (!phone) return;
  
  const courier = {
    id: nextCourierId++,
    name: name,
    phone: phone,
    status: 'active',
    orders: []
  };
  
  couriers.push(courier);
  localStorage.setItem('artikFoodCouriers', JSON.stringify(couriers));
  updateAdminStats();
  alert(`–ö—É—Ä—å–µ—Ä ${name} –¥–æ–±–∞–≤–ª–µ–Ω!`);
}

function toggleCourierStatus(courierId) {
  const courier = couriers.find(c => c.id === courierId);
  if (courier) {
    courier.status = courier.status === 'active' ? 'inactive' : 'active';
    localStorage.setItem('artikFoodCouriers', JSON.stringify(couriers));
    updateAdminStats();
  }
}

function manageCouriers() {
  alert("–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—å–µ—Ä–∞–º–∏\n\n–î–æ–±–∞–≤–ª–µ–Ω–æ –∫—É—Ä—å–µ—Ä–æ–≤: " + couriers.length + 
        "\n–ê–∫—Ç–∏–≤–Ω—ã—Ö: " + couriers.filter(c => c.status === 'active').length);
}

// –î—Ä—É–≥–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∫–∏
function addNewProduct() {
  alert("–ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.");
}

function viewAllOrders() {
  alert("–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤: " + orders.length + 
        "\n–ù–∞ —Å—É–º–º—É: " + orders.reduce((sum, o) => sum + o.total, 0) + " AMD");
}

function backupData() {
  const data = {
    orders: orders,
    couriers: couriers,
    notifications: notifications,
    timestamp: new Date().toISOString()
  };
  
  const dataStr = JSON.stringify(data, null, 2);
  const dataBlob = new Blob([dataStr], { type: 'application/json' });
  const url = URL.createObjectURL(dataBlob);
  
  const link = document.createElement('a');
  link.href = url;
  link.download = `artikfood_backup_${Date.now()}.json`;
  link.click();
  
  URL.revokeObjectURL(url);
  
  alert('–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞ –∏ —Å–∫–∞—á–∞–Ω–∞!');
}

/* ========== –ö–ù–û–ü–ö–ò –î–û–°–¢–£–ü–ê ========== */

function addAdminAndCourierButtons() {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∫–Ω–æ–ø–∫–∏
  if (document.getElementById('admin-access-buttons')) return;
  
  // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫
  const buttonContainer = document.createElement('div');
  buttonContainer.id = 'admin-access-buttons';
  buttonContainer.style.position = 'fixed';
  buttonContainer.style.top = '10px';
  buttonContainer.style.right = '10px';
  buttonContainer.style.zIndex = '9999';
  buttonContainer.style.display = 'flex';
  buttonContainer.style.gap = '10px';
  buttonContainer.style.flexDirection = 'column';
  
  // –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∫—É
  const adminButton = document.createElement('button');
  adminButton.innerHTML = 'üëë –ê–¥–º–∏–Ω';
  adminButton.style.padding = '8px 15px';
  adminButton.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
  adminButton.style.color = 'white';
  adminButton.style.border = 'none';
  adminButton.style.borderRadius = '25px';
  adminButton.style.cursor = 'pointer';
  adminButton.style.fontWeight = 'bold';
  adminButton.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
  adminButton.onclick = showAdminLogin;
  
  // –ö–Ω–æ–ø–∫–∞ –º–µ–Ω—é –∫—É—Ä—å–µ—Ä–∞
  const courierButton = document.createElement('button');
  courierButton.innerHTML = 'üö¥ –ö—É—Ä—å–µ—Ä';
  courierButton.style.padding = '8px 15px';
  courierButton.style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
  courierButton.style.color = 'white';
  courierButton.style.border = 'none';
  courierButton.style.borderRadius = '25px';
  courierButton.style.cursor = 'pointer';
  courierButton.style.fontWeight = 'bold';
  courierButton.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';
  courierButton.onclick = showCourierLogin;
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  buttonContainer.appendChild(adminButton);
  buttonContainer.appendChild(courierButton);
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
  document.body.appendChild(buttonContainer);
}

/* ========== –ü–ê–ù–ï–õ–¨ –ö–£–†–¨–ï–†–ê ========== */

function showCourierLogin() {
  const courierId = prompt("–í–≤–µ–¥–∏—Ç–µ ID –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω –∫—É—Ä—å–µ—Ä–∞:");
  
  if (!courierId) return;
  
  const courier = couriers.find(c => c.id == courierId || c.phone === courierId);
  
  if (courier) {
    showCourierPanel(courier);
  } else {
    alert("–ö—É—Ä—å–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");
  }
}

function showCourierPanel(courier) {
  // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–∞
  document.getElementById('admin-access-buttons').style.display = 'none';
  
  // –°–æ–∑–¥–∞–µ–º –ø–∞–Ω–µ–ª—å –∫—É—Ä—å–µ—Ä–∞
  const courierPanel = document.createElement('div');
  courierPanel.id = 'courier-panel';
  courierPanel.style.position = 'fixed';
  courierPanel.style.top = '0';
  courierPanel.style.left = '0';
  courierPanel.style.width = '100%';
  courierPanel.style.height = '100%';
  courierPanel.style.background = 'white';
  courierPanel.style.zIndex = '1000';
  courierPanel.style.overflowY = 'auto';
  courierPanel.style.padding = '20px';
  
  // –ó–∞–≥–æ–ª–æ–≤–æ–∫
  const header = document.createElement('div');
  header.style.display = 'flex';
  header.style.justifyContent = 'space-between';
  header.style.alignItems = 'center';
  header.style.marginBottom = '20px';
  header.style.paddingBottom = '15px';
  header.style.borderBottom = '2px solid #eee';
  
  header.innerHTML = `
    <div>
      <h2 style="margin: 0; color: #333;">üö¥ –ü–∞–Ω–µ–ª—å –∫—É—Ä—å–µ—Ä–∞</h2>
      <p style="margin: 5px 0 0 0; color: #666;">${courier.name} | ${courier.phone}</p>
      <p style="margin: 0; font-size: 12px; color: #999;">–°—Ç–∞—Ç—É—Å: ${courier.status === 'active' ? 'üü¢ –ê–∫—Ç–∏–≤–µ–Ω' : 'üî¥ –ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</p>
    </div>
    <button onclick="exitCourierPanel()" style="padding: 8px 15px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer;">
      –í—ã—Ö–æ–¥
    </button>
  `;
  
  // –í–∫–ª–∞–¥–∫–∏
  const tabs = document.createElement('div');
  tabs.style.display = 'flex';
  tabs.style.gap = '10px';
  tabs.style.marginBottom = '20px';
  tabs.style.borderBottom = '1px solid #ddd';
  tabs.style.paddingBottom = '10px';
  
  tabs.innerHTML = `
    <button onclick="showCourierTab('orders')" id="courier-tab-orders" style="padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px 5px 0 0; cursor: pointer;">
      üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã
    </button>
    <button onclick="showCourierTab('notifications')" id="courier-tab-notifications" style="padding: 10px 20px; background: #f8f9fa; color: #333; border: none; border-radius: 5px 5px 0 0; cursor: pointer;">
      üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    </button>
    <button onclick="showCourierTab('stats')" id="courier-tab-stats" style="padding: 10px 20px; background: #f8f9fa; color: #333; border: none; border-radius: 5px 5px 0 0; cursor: pointer;">
      üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    </button>
  `;
  
  // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
  const tabContent = document.createElement('div');
  tabContent.id = 'courier-tab-content';
  tabContent.style.padding = '20px';
  tabContent.style.background = '#f8f9fa';
  tabContent.style.borderRadius = '5px';
  tabContent.style.minHeight = '400px';
  
  // –°–æ–±–∏—Ä–∞–µ–º –ø–∞–Ω–µ–ª—å
  courierPanel.appendChild(header);
  courierPanel.appendChild(tabs);
  courierPanel.appendChild(tabContent);
  
  document.body.appendChild(courierPanel);
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
  showCourierTab('orders');
}

function exitCourierPanel() {
  const panel = document.getElementById('courier-panel');
  if (panel) panel.remove();
  
  const accessButtons = document.getElementById('admin-access-buttons');
  if (accessButtons) accessButtons.style.display = 'flex';
}

function showCourierTab(tabName) {
  // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
  document.querySelectorAll('#courier-panel button[id^="courier-tab-"]').forEach(btn => {
    btn.style.background = '#f8f9fa';
    btn.style.color = '#333';
  });
  
  const activeBtn = document.getElementById(`courier-tab-${tabName}`);
  if (activeBtn) {
    activeBtn.style.background = '#3498db';
    activeBtn.style.color = 'white';
  }
  
  const tabContent = document.getElementById('courier-tab-content');
  
  switch(tabName) {
    case 'orders':
      showCourierOrders();
      break;
    case 'notifications':
      showCourierNotificationsTab();
      break;
    case 'stats':
      showCourierStats();
      break;
  }
}

function showCourierOrders() {
  const tabContent = document.getElementById('courier-tab-content');
  
  // –ù–∞—Ö–æ–¥–∏–º —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä—å–µ—Ä–∞
  const courierPanel = document.getElementById('courier-panel');
  const courierName = courierPanel ? courierPanel.querySelector('p').textContent.split('|')[0].trim() : '';
  
  // –ù–∞—Ö–æ–¥–∏–º –∑–∞–∫–∞–∑—ã —ç—Ç–æ–≥–æ –∫—É—Ä—å–µ—Ä–∞
  const courierOrders = orders.filter(order => order.courier && order.courier.includes(courierName));
  
  let html = `
    <h3 style="margin-top: 0;">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h3>
    <div style="display: flex; gap: 10px; margin-bottom: 20px;">
      <button onclick="refreshCourierOrders()" style="padding: 5px 10px; background: #3498db; color: white; border: none; border-radius: 3px; cursor: pointer;">
        üîÑ –û–±–Ω–æ–≤–∏—Ç—å
      </button>
    </div>
  `;
  
  if (courierOrders.length === 0) {
    html += `
      <div style="text-align: center; padding: 40px; color: #777; background: white; border-radius: 5px;">
        <p style="font-size: 18px; margin-bottom: 10px;">üò¥ –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</p>
        <p>–û–∂–∏–¥–∞–π—Ç–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤</p>
      </div>
    `;
  } else {
    html += '<div style="display: flex; flex-direction: column; gap: 15px;">';
    
    courierOrders.forEach(order => {
      const statusColors = {
        'new': '#3498db',
        'assigned': '#f39c12',
        'delivering': '#9b59b6',
        'delivered': '#2ecc71',
        'cancelled': '#e74c3c'
      };
      
      const statusText = {
        'new': '–ù–æ–≤—ã–π',
        'assigned': '–ù–∞–∑–Ω–∞—á–µ–Ω',
        'delivering': '–í –¥–æ—Å—Ç–∞–≤–∫–µ',
        'delivered': '–î–æ—Å—Ç–∞–≤–ª–µ–Ω',
        'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
      };
      
      const status = order.status || 'new';
      const statusColor = statusColors[status] || '#95a5a6';
      
      html += `
        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 5px solid ${statusColor}; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
              <h4 style="margin: 0 0 5px 0;">–ó–∞–∫–∞–∑ #${order.id}</h4>
              <p style="margin: 0 0 5px 0; font-size: 14px; color: #666;">${order.name} ‚Ä¢ ${order.phone}</p>
              <p style="margin: 0; font-size: 13px; color: #999;">${order.address} (${order.district})</p>
            </div>
            <div style="text-align: right;">
              <span style="background: ${statusColor}; color: white; padding: 3px 10px; border-radius: 15px; font-size: 12px;">
                ${statusText[status] || status}
              </span>
              <p style="margin: 5px 0 0 0; font-weight: bold; color: #2c3e50;">${order.total} AMD</p>
            </div>
          </div>
          <div style="margin-top: 15px; display: flex; gap: 10px;">
            ${status === 'assigned' ? `
              <button onclick="updateOrderStatus(${order.id}, 'delivering')" style="padding: 8px 15px; background: #9b59b6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                üö¥ –ù–∞—á–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É
              </button>
            ` : ''}
            ${status === 'delivering' ? `
              <button onclick="updateOrderStatus(${order.id}, 'delivered')" style="padding: 8px 15px; background: #2ecc71; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                ‚úÖ –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
              </button>
            ` : ''}
            <button onclick="viewOrderDetails(${order.id})" style="padding: 8px 15px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
              üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏
            </button>
            <button onclick="callCustomer('${order.phone}')" style="padding: 8px 15px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
              üìû –ü–æ–∑–≤–æ–Ω–∏—Ç—å
            </button>
          </div>
          ${order.comment ? `
            <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
              <strong>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${order.comment}
            </div>
          ` : ''}
        </div>
      `;
    });
    
    html += '</div>';
  }
  
  tabContent.innerHTML = html;
}

function showCourierNotificationsTab() {
  const tabContent = document.getElementById('courier-tab-content');
  
  const courierNotifications = notifications.couriers || [];
  
  let html = `
    <h3 style="margin-top: 0;">üîî –ú–æ–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <div>
        <button onclick="refreshCourierNotifications()" style="padding: 5px 10px; background: #3498db; color: white; border: none; border-radius: 3px; cursor: pointer;">
          üîÑ –û–±–Ω–æ–≤–∏—Ç—å
        </button>
        <button onclick="markAllNotificationsAsRead()" style="padding: 5px 10px; background: #2ecc71; color: white; border: none; border-radius: 3px; cursor: pointer; margin-left: 10px;">
          ‚úÖ –í—Å–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ
        </button>
      </div>
      <span style="font-size: 12px; color: #666;">
        –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö: <strong>${courierNotifications.filter(n => !n.read).length}</strong>
      </span>
    </div>
  `;
  
  if (courierNotifications.length === 0) {
    html += `
      <div style="text-align: center; padding: 40px; color: #777; background: white; border-radius: 5px;">
        <p style="font-size: 18px; margin-bottom: 10px;">üì≠ –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</p>
        <p>–í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</p>
      </div>
    `;
  } else {
    const unread = courierNotifications.filter(n => !n.read);
    const read = courierNotifications.filter(n => n.read).slice(-10);
    
    if (unread.length > 0) {
      html += '<h4 style="color: #e74c3c; margin-bottom: 10px;">–ù–æ–≤—ã–µ</h4>';
      html += '<div style="margin-bottom: 20px;">';
      
      unread.forEach(notification => {
        html += `
          <div style="background: #fff3cd; padding: 12px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #ffeaa7;">
            <div style="display: flex; justify-content: space-between; align-items: start;">
              <div>
                <strong>${notification.type || '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ'}</strong>
                <p style="margin: 5px 0; font-size: 13px;">${notification.details || ''}</p>
                <small style="color: #999;">${notification.timestamp || ''}</small>
              </div>
              <button onclick="markNotificationAsRead(${notification.id}, 'courier')" style="padding: 4px 10px; background: #3498db; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 12px;">
                –ü—Ä–æ—á–∏—Ç–∞–Ω–æ
              </button>
            </div>
          </div>
        `;
      });
      
      html += '</div>';
    }
    
    if (read.length > 0) {
      html += '<h4 style="color: #7f8c8d; margin-bottom: 10px;">–†–∞–Ω–µ–µ</h4>';
      html += '<div style="opacity: 0.7;">';
      
      read.forEach(notification => {
        html += `
          <div style="background: #f8f9fa; padding: 10px; margin-bottom: 8px; border-radius: 6px; border: 1px solid #ddd;">
            <div>
              <strong>${notification.type || '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ'}</strong>
              <p style="margin: 5px 0; font-size: 13px;">${notification.details || ''}</p>
              <small style="color: #999;">${notification.timestamp || ''}</small>
            </div>
          </div>
        `;
      });
      
      html += '</div>';
    }
  }
  
  tabContent.innerHTML = html;
}

function showCourierStats() {
  const tabContent = document.getElementById('courier-tab-content');
  
  // –ù–∞—Ö–æ–¥–∏–º —Ç–µ–∫—É—â–µ–≥–æ –∫—É—Ä—å–µ—Ä–∞
  const courierPanel = document.getElementById('courier-panel');
  const courierName = courierPanel ? courierPanel.querySelector('p').textContent.split('|')[0].trim() : '';
  
  const courierOrders = orders.filter(order => order.courier && order.courier.includes(courierName));
  const today = new Date().toDateString();
  const todayOrders = courierOrders.filter(order => 
    new Date(order.date).toDateString() === today
  );
  
  const completedOrders = courierOrders.filter(order => 
    order.status === 'delivered'
  );
  
  const totalEarnings = completedOrders.reduce((sum, order) => sum + (order.total * 0.1), 0);
  
  const html = `
    <h3 style="margin-top: 0;">üìä –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
      <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold;">${courierOrders.length}</div>
        <div>–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
      </div>
      
      <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold;">${todayOrders.length}</div>
        <div>–°–µ–≥–æ–¥–Ω—è</div>
      </div>
      
      <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold;">${completedOrders.length}</div>
        <div>–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</div>
      </div>
      
      <div style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; padding: 20px; border-radius: 8px; text-align: center;">
        <div style="font-size: 32px; font-weight: bold;">${Math.round(totalEarnings)}</div>
        <div>–ó–∞—Ä–∞–±–æ—Ç–æ–∫ (AMD)</div>
      </div>
    </div>
    
    <h4>üìà –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h4>
    <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
      ${
        completedOrders.length === 0 ? 
        '<p style="text-align: center; color: #777; padding: 20px;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞—Ö</p>' :
        completedOrders.slice(-5).reverse().map(order => `
          <div style="padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between;">
            <div>
              <strong>–ó–∞–∫–∞–∑ #${order.id}</strong><br>
              <small>${order.address} ‚Ä¢ ${order.date}</small>
            </div>
            <div style="text-align: right;">
              <strong>${order.total} AMD</strong><br>
              <small style="color: #27ae60;">+${Math.round(order.total * 0.1)} AMD</small>
            </div>
          </div>
        `).join('')
      }
    </div>
    
    <div style="margin-top: 20px; padding: 15px; background: #e8f4fc; border-radius: 8px;">
      <h4 style="margin-top: 0;">üí° –°–æ–≤–µ—Ç—ã</h4>
      <ul style="margin: 10px 0; padding-left: 20px;">
        <li>–í—Å–µ–≥–¥–∞ –∑–≤–æ–Ω–∏—Ç–µ –∫–ª–∏–µ–Ω—Ç—É –ø–µ—Ä–µ–¥ –≤—ã–µ–∑–¥–æ–º</li>
        <li>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ</li>
        <li>–°–æ–æ–±—â–∞–π—Ç–µ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É</li>
        <li>–°–æ–±–ª—é–¥–∞–π—Ç–µ —Å—Ä–æ–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏</li>
      </ul>
    </div>
  `;
  
  tabContent.innerHTML = html;
}

/* ========== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ========== */

function updateOrderStatus(orderId, newStatus) {
  const orderIndex = orders.findIndex(order => order.id == orderId);
  
  if (orderIndex !== -1) {
    orders[orderIndex].status = newStatus;
    orders[orderIndex].statusDate = new Date().toLocaleString();
    localStorage.setItem('artikFoodOrders', JSON.stringify(orders));
    
    const statusText = {
      'delivering': '–¥–æ—Å—Ç–∞–≤–∫–µ',
      'delivered': '–¥–æ—Å—Ç–∞–≤–ª–µ–Ω',
      'cancelled': '–æ—Ç–º–µ–Ω–µ–Ω'
    };
    
    sendNotification(
      newStatus === 'delivered' ? 'ORDER_DELIVERED' : 'ORDER_ACCEPTED',
      'courier',
      orderId,
      `–ó–∞–∫–∞–∑ #${orderId} ${statusText[newStatus] || '–æ–±–Ω–æ–≤–ª–µ–Ω'}`
    );
    
    alert(`–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞: ${newStatus}`);
    showCourierOrders();
  }
}

function viewOrderDetails(orderId) {
  const order = orders.find(o => o.id == orderId);
  
  if (order) {
    let itemsText = '';
    if (order.items) {
      Object.entries(order.items).forEach(([storeKey, items]) => {
        Object.entries(items).forEach(([itemName, itemData]) => {
          if (itemData.qty > 0) {
            itemsText += `${itemName} √ó ${itemData.qty} = ${itemData.qty * itemData.price} AMD\n`;
          }
        });
      });
    }
    
    alert(
      `üìã –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞ #${orderId}\n\n` +
      `üë§ –ò–º—è: ${order.name}\n` +
      `üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${order.phone}\n` +
      `üìç –ê–¥—Ä–µ—Å: ${order.address} (${order.district})\n` +
      `üí∞ –°—É–º–º–∞: ${order.total} AMD\n` +
      `üöö –î–æ—Å—Ç–∞–≤–∫–∞: ${order.delivery || 0} AMD\n` +
      `üí≥ –û–ø–ª–∞—Ç–∞: ${order.payment || '–Ω–µ —É–∫–∞–∑–∞–Ω–æ'}\n\n` +
      `üõí –¢–æ–≤–∞—Ä—ã:\n${itemsText || '–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏'}\n\n` +
      `üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${order.comment || '–Ω–µ—Ç'}\n` +
      `üìÖ –î–∞—Ç–∞: ${order.date}\n` +
      `üìä –°—Ç–∞—Ç—É—Å: ${order.status || '–Ω–æ–≤—ã–π'}`
    );
  }
}

function callCustomer(phone) {
  if (confirm(`–ü–æ–∑–≤–æ–Ω–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É: ${phone}?`)) {
    window.open(`tel:${phone}`);
  }
}

function markAllNotificationsAsRead() {
  notifications.couriers.forEach(notification => {
    notification.read = true;
  });
  
  saveNotifications();
  showCourierNotificationsTab();
}

function refreshCourierOrders() {
  showCourierOrders();
}

function refreshCourierNotifications() {
  showCourierNotificationsTab();
}

/* ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ========== */

// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
  const savedOrders = localStorage.getItem('artikFoodOrders');
  const savedCouriers = localStorage.getItem('artikFoodCouriers');
  
  if (savedOrders) orders = JSON.parse(savedOrders);
  if (savedCouriers) {
    couriers = JSON.parse(savedCouriers);
    // –ù–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π ID –¥–ª—è nextCourierId
    if (couriers.length > 0) {
      nextCourierId = Math.max(...couriers.map(c => c.id)) + 1;
    }
  }
  
  // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  autoCleanupNotifications();
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –¥–æ—Å—Ç—É–ø–∞
  addAdminAndCourierButtons();
  
  // –†–µ–Ω–¥–µ—Ä–∏–º –º–∞–≥–∞–∑–∏–Ω—ã
  renderShops();
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
  goHome();
  
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
  updateNotificationCounters();
});
</script>

</body>
</html>
